
| í•­ëª©  | ë‚´ìš©                            |
| --- | ----------------------------- |
| ëª©í‘œ  | í…ìŠ¤íŠ¸ë¥¼ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰        |
| ëª¨ë¸  | BGE-M3 (ë‹¤êµ­ì–´, 1024ì°¨ì›)          |
| ë°ì´í„° | ì•„ë§ˆì¡´ ì‹í’ˆ ë¦¬ë·° 1000ê°œ               |
| í™˜ê²½  | Ubuntu + RTX 5080 (16GB VRAM) |
### ì„ë² ë”©ì´ë€?

```
í…ìŠ¤íŠ¸ â†’ ìˆ«ì ë²¡í„° ë³€í™˜

"ë§›ìˆëŠ” ì»¤í”¼" â†’ [0.12, -0.34, 0.56, ..., 0.23] (1024ê°œ ìˆ«ì)
"delicious coffee" â†’ [0.11, -0.33, 0.55, ..., 0.24] (ë¹„ìŠ·í•œ ë²¡í„°!)

ì˜ë¯¸ê°€ ë¹„ìŠ·í•˜ë©´ ë²¡í„°ë„ ë¹„ìŠ· â†’ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¡œ ê²€ìƒ‰
```

---

### ì„ë² ë”© vs LLM

|      | ì„ë² ë”© ëª¨ë¸          | LLM          |
| ---- | --------------- | ------------ |
| í•˜ëŠ” ì¼ | í…ìŠ¤íŠ¸ â†’ ë²¡í„°        | í…ìŠ¤íŠ¸ â†’ í…ìŠ¤íŠ¸ ìƒì„± |
| ì¶œë ¥   | [0.1, 0.2, ...] | "ë‹µë³€ì…ë‹ˆë‹¤..."   |
| ìš©ë„   | ê²€ìƒ‰, ë¶„ë¥˜, ìœ ì‚¬ë„     | ëŒ€í™”, ìš”ì•½, ë²ˆì—­   |
| ì˜ˆì‹œ   | BGE-M3, E5      | Llama, Qwen  |

---

### RAGì—ì„œì˜ ì—­í• 

```
[ì‚¬ìš©ì ì§ˆë¬¸]
      â†“
[ì„ë² ë”© ëª¨ë¸] â†’ ì§ˆë¬¸ ë²¡í„°í™” â†’ ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰ â† ì—¬ê¸°!
      â†“
[LLM] â†’ ë¬¸ì„œ + ì§ˆë¬¸ìœ¼ë¡œ ë‹µë³€ ìƒì„±
```

**ì„ë² ë”© = ê²€ìƒ‰ ë‹´ë‹¹ (R)** **LLM = ìƒì„± ë‹´ë‹¹ (G)**

---

### íŒŒì¼ êµ¬ì¡°

```
~/ai-projects/embedding/
â”œâ”€â”€ fine_food_reviews_1k.csv        # ì›ë³¸ ë°ì´í„° (436KB)
â”œâ”€â”€ embedded_1k_reviews_local.csv   # ë²¡í„° í¬í•¨ (23MB) ì›ë³¸ë°ì´í„° ë²¡í„°í™”
â”œâ”€â”€ create_embeddings.py            # ì„ë² ë”© ìƒì„±
â””â”€â”€ semantic_search.py              # ì‹œë§¨í‹± ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
```

---

### í™˜ê²½ ì„¤ì •


```bash
source ~/ai-projects/venv/bin/activate

pip install sentence-transformers pandas scikit-learn matplotlib
```

---

### 1. ì„ë² ë”© ìƒì„± (create_embeddings.py)

```python
"""
ì„ë² ë”© ìƒì„± - BGE-M3
"""
import pandas as pd
import subprocess
from sentence_transformers import SentenceTransformer

# ============================================
# 1. ì„ë² ë”© ëª¨ë¸ ë¡œë“œ
# ============================================
print("ì„ë² ë”© ëª¨ë¸ ë¡œë”©...")
model = SentenceTransformer('BAAI/bge-m3')

def get_embedding(text):
    return model.encode(text, normalize_embeddings=True)

# ============================================
# 2. ë°ì´í„° ë‹¤ìš´ë¡œë“œ & ì„ë² ë”©
# ============================================
print("ë°ì´í„° ë‹¤ìš´ë¡œë“œ...")
subprocess.run(["wget", "-q", 
    "https://raw.githubusercontent.com/openai/openai-cookbook/main/examples/data/fine_food_reviews_1k.csv", 
    "-O", "fine_food_reviews_1k.csv"])

df = pd.read_csv("fine_food_reviews_1k.csv", index_col=0)
df = df[["Time", "ProductId", "UserId", "Score", "Summary", "Text"]]
df = df.dropna()
df["combined"] = "Title: " + df.Summary.str.strip() + "; Content: " + df.Text.str.strip()

print(f"ë°ì´í„° ìˆ˜: {len(df)}")
print("ì„ë² ë”© ìƒì„± ì¤‘... (2-3ë¶„ ì†Œìš”)")

df['embedding'] = df.combined.apply(get_embedding).apply(lambda x: x.tolist())
df.to_csv('embedded_1k_reviews_local.csv', index=False)

print("ì™„ë£Œ: embedded_1k_reviews_local.csv")
print(f"ì„ë² ë”© ì°¨ì›: {len(df.iloc[0]['embedding'])}")
```

---

### 2. ì‹œë§¨í‹± ê²€ìƒ‰ (semantic_search.py)

```python
"""
ì‹œë§¨í‹± ê²€ìƒ‰ - ì„ë² ë”© ê¸°ë°˜ ìœ ì‚¬ë„ ê²€ìƒ‰
"""
import pandas as pd
import numpy as np
from ast import literal_eval
from sentence_transformers import SentenceTransformer

# ============================================
# 1. ëª¨ë¸ & ë°ì´í„° ë¡œë“œ
# ============================================
print("ëª¨ë¸ ë¡œë”©...")
model = SentenceTransformer('BAAI/bge-m3')

print("ì„ë² ë”© ë°ì´í„° ë¡œë“œ...")
df = pd.read_csv("embedded_1k_reviews_local.csv")
df["embedding"] = df.embedding.apply(literal_eval).apply(np.array)

# ============================================
# 2. ê²€ìƒ‰ í•¨ìˆ˜
# ============================================
def cosine_similarity(a, b):
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))

def search_reviews(query, n=3):
    query_embedding = model.encode(query, normalize_embeddings=True)
    df["similarity"] = df.embedding.apply(lambda x: cosine_similarity(x, query_embedding))
    results = df.sort_values("similarity", ascending=False).head(n)
    
    print(f"\nğŸ” ê²€ìƒ‰: '{query}'")
    print("=" * 60)
    for _, row in results.iterrows():
        print(f"\n[ìœ ì‚¬ë„: {row['similarity']:.4f}] â­ {row['Score']}ì ")
        print(f"ì œëª©: {row['Summary']}")
        print(f"ë‚´ìš©: {row['Text'][:150]}...")
    return results

# ============================================
# 3. í…ŒìŠ¤íŠ¸
# ============================================
if __name__ == "__main__":
    search_reviews("delicious coffee", n=3)
    search_reviews("bad delivery", n=2)
    search_reviews("dog food", n=2)
    
    # í•œêµ­ì–´ë„ í…ŒìŠ¤íŠ¸ (BGE-M3ëŠ” ë‹¤êµ­ì–´ ì§€ì›)
    search_reviews("ë§›ìˆëŠ” ì»¤í”¼", n=2)
```

---

### ì‹¤í–‰

````bash
cd ~/ai-projects/embedding
source ~/ai-projects/venv/bin/activate

python create_embeddings.py   # ì„ë² ë”© ìƒì„± (ìµœì´ˆ 1íšŒ)
python semantic_search.py     # ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
```

---

### ê²€ìƒ‰ ê²°ê³¼ ì˜ˆì‹œ
```
ğŸ” ê²€ìƒ‰: 'ë§›ìˆëŠ” ì»¤í”¼'
============================================================

[ìœ ì‚¬ë„: 0.8336] â­ 5ì 
ì œëª©: Excellent taste
ë‚´ìš©: This is to me a great coffee, once you try it you will enjoy it...

[ìœ ì‚¬ë„: 0.8261] â­ 5ì 
ì œëª©: amazing taste
ë‚´ìš©: This coffee is amazing...nice flavor..very smooth...
```

**í•µì‹¬**: í•œêµ­ì–´ "ë§›ìˆëŠ” ì»¤í”¼"ë¡œ ì˜ì–´ ë¦¬ë·° ê²€ìƒ‰ë¨ â†’ ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰!

---

### ì²˜ë¦¬ íë¦„
```
1. ì €ì¥ ë‹¨ê³„
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[1000ê°œ ë¦¬ë·°] â†’ BGE-M3 â†’ [1000ê°œ ë²¡í„°] â†’ CSV ì €ì¥

2. ê²€ìƒ‰ ë‹¨ê³„
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[ê²€ìƒ‰ì–´] â†’ BGE-M3 â†’ [ê²€ìƒ‰ ë²¡í„°]
                          â†“
              [1000ê°œ ë²¡í„°ì™€ ìœ ì‚¬ë„ ê³„ì‚°]
                          â†“
              [ìƒìœ„ Nê°œ ê²°ê³¼ ë°˜í™˜]
```

---

### 2025ë…„ ì„ë² ë”© ëª¨ë¸ ì¶”ì²œ

| ëª¨ë¸ | í¬ê¸° | íŠ¹ì§• |
|---|---|---|
| **BGE-M3** | 2.2GB | ë‹¤êµ­ì–´ ìµœê³  ì„±ëŠ¥, 100+ ì–¸ì–´ |
| BGE-m3-ko | 2.2GB | í•œêµ­ì–´ íŠ¹í™” |
| multilingual-e5-large | 2.2GB | ë²”ìš© ë‹¤êµ­ì–´ |
| multilingual-e5-base | 1.1GB | ê°€ë²¼ìš´ ë²„ì „ |

---

### RAG ì „ì²´ êµ¬ì„± (ë‹¤ìŒ ë‹¨ê³„)
```
[ì„ë² ë”©: BGE-M3] + [ë²¡í„°DB: Chroma] + [LLM: Qwen2.5-7B]
      â†“                   â†“                  â†“
   ê²€ìƒ‰ ë‹´ë‹¹           ì €ì¥/ê²€ìƒ‰           ìƒì„± ë‹´ë‹¹
````

---

### í•µì‹¬ í¬ì¸íŠ¸

1. **ì„ë² ë”©** â€” í…ìŠ¤íŠ¸ë¥¼ ë²¡í„°ë¡œ ë³€í™˜, ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ ê°€ëŠ¥
2. **ë‹¤êµ­ì–´** â€” BGE-M3ëŠ” "ë§›ìˆëŠ” ì»¤í”¼" â†’ "delicious coffee" ë§¤ì¹­
3. **RAGì˜ R** â€” ì„ë² ë”©ì´ ê²€ìƒ‰ ë‹´ë‹¹, LLMì€ ìƒì„± ë‹´ë‹¹
4. **ì‹¤ë¬´ í™œìš©** â€” ë¬¸ì„œ ê²€ìƒ‰, ì±—ë´‡, ì¶”ì²œ ì‹œìŠ¤í…œ ë“±