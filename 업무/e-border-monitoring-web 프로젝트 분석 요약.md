

  프로젝트 개요

  항공 출입국 관리 모니터링 시스템 - 여러 국가의 항공 데이터를 실시간으로 수집하고 모니터링하는 웹 애플리케이션입니다.

  기술 스택
  - 백엔드: Java 8, Spring Framework 4.3, MyBatis
  - 웹서버: Apache Tomcat
  - 데이터베이스: MySQL (다중 데이터소스)
  - 프론트엔드: jQuery, DataTables, jqPlot
  - 캐시: Redis
  - 보안: RSA 암호화, CAPTCHA

  주요 기능 모듈

  1. IAPP (Airline Intelligent Application Processing)
    - 항공사 데이터 수집 및 모니터링
    - 탑승객 정보 관리
  2. PNR (Passenger Name Record)
    - 탑승객명부 수집 및 관리
    - 한국/일본 지역별 운영
  3. LDCS (Load Balancing DCS)
    - 항공편 정보 관리
    - 출발 통제 시스템
  4. PFMS (Flight Management System)
    - 항공편 정보 관리
    - 알림 이력 추적
  5. 관리자 기능
    - 사용자/서버 관리
    - 로그 조회

  아키텍처 특징

  - 3계층 아키텍처: Controller → Service → DAO
  - 다국가 지원: 한국, 대만, 남아공 각각 독립 데이터소스
  - 동적 데이터소스 라우팅: 요청에 따라 자동으로 DB 전환
  - AOP 기반: 로깅, 트랜잭션, 메서드 추적
  - 보안 강화: 세션 타임아웃 8시간, RSA 암호화, CORS 지원

  디렉토리 구조

  src/ - 자바 소스 (102개 파일)
    ├─ beans/ - 데이터 모델
    ├─ controller/ - 요청 처리
    ├─ service/ - 비즈니스 로직
    └─ dao/ - 데이터 접근

  src_resource/ - 설정 파일
    └─ resource/
        ├─ spring/ - Spring 설정
        └─ mapper/ - MyBatis 매퍼 (23개)

  WebContent/ - 웹 리소스
    ├─ js/ - JavaScript (51개)
    ├─ template/ - HTML 템플릿
    └─ css/ - 스타일시트

  현재 작업

  - 브랜치: 61-feature-ldcs-update (LDCS 기능 업데이트 중)
  - 최근 변경: 데이터소스 정리, Docker 경로 변경

  이 시스템은 항공사와 출입국 관리청 간의 핵심 데이터를 실시간으로 처리하는 엔터프라이즈급 애플리케이션입니다.


● 네, 명확한 레거시 프로젝트입니다.

  레거시로 판단되는 주요 근거:

  1. 오래된 기술 스택

  - Java 8 (2014년) - 현재 Java 21까지 출시됨
  - Spring Framework 4.3 (2016년) - 현재 Spring 6.x / Spring Boot 3.x 시대
  - iBatis + MyBatis 혼용 - iBatis는 2010년에 MyBatis로 개명, 매우 오래됨
  - jQuery 기반 UI - 현대 웹은 React, Vue, Angular 등 사용
  - jqPlot, DataTables - 구세대 jQuery 플러그인

  2. 구식 개발 방식

  - XML 기반 설정 - 현대는 Java Config, Annotation 중심
  applicationContext.xml
  action-servlet.xml
  web.xml
  - 빌드 도구 없음 - Maven/Gradle 대신 Eclipse 프로젝트 직접 관리
  - JSP/Servlet 패턴 - 현대적인 SPA나 REST API + 프론트엔드 분리 구조 아님
  - .do URL 패턴 - 전형적인 2000년대 Struts/Spring MVC 스타일

  3. 혼재된 기술
  - MyBatis + iBatis 동시 사용
  - JDBC Template도 일부 사용
  - 3가지 데이터 접근 방식이 섞여있음

  4. 레거시 인프라
  - Tomcat WAR 배포 - 현대는 Spring Boot embedded 서버
  - Docker 경로도 직접 관리
  - 파일 업로드 로컬 저장 - 클라우드 스토리지 미사용

  하지만...
  여전히 운영 중인 시스템
  - ✅ 현재도 기능 추가 중 (LDCS 업데이트)
  - ✅ 다국가 운영 (한국, 대만, 남아공)
  - ✅ 중요한 출입국 관리 시스템
  - ✅ 체계적인 로깅과 모니터링
  - ✅ 보안 강화 (RSA, CAPTCHA)

  결론

  **전형적인 "운영 중인 레거시 시스템"**입니다.
  - 10년 전 기술 스택
  - 유지보수는 가능하지만 현대화 필요
  - 새 기능 추가보다 리팩토링/마이그레이션 검토가 권장됨

  현대화 고려사항:
  1. Spring Boot 3.x 마이그레이션
  2. React/Vue 프론트엔드 분리
  3. Gradle/Maven 도입
  4. Java 17/21 업그레이드
  5. REST API 표준화

  중요 시스템이라 점진적 현대화 전략이 필요합니다.

현대화 난이도 평가: 중상 ~ 상 🔴

  이 프로젝트는 상당히 어렵습니다. 구체적으로 분석하면:

  ---
  1. 규모 측면 (중간)

  ✓ Java 파일: 102개
  ✓ MyBatis 매퍼: 23개
  ✓ JavaScript: 51개
  ✓ HTML 템플릿: 20개 이상
  ✓ 총 라인 수: 수만 라인 추정

  판단: 중소규모지만 도메인 복잡도가 높음

  ---
  2. 기술 부채 측면 (높음 🔴)

  심각한 문제들:

  (1) iBatis + MyBatis 혼용

  resource/ibatis/sqlMapConfig.xml  ← 2010년 이전 기술
  resource/mapper/*.xml              ← MyBatis (최신)
  - 난이도: ⭐⭐⭐⭐ (매우 높음)
  - iBatis는 레거시 중의 레거시
  - SQL 문법 차이로 전체 매퍼 재작성 필요
  - 예상 작업: 23개 매퍼 전체 검증 + 리팩토링

  (2) 3가지 데이터 접근 방식 혼재

  iBatis (레거시)
  MyBatis (표준)
  JDBC Template (일부)
  - 난이도: ⭐⭐⭐⭐⭐ (극악)
  - 통일성 없음
  - 마이그레이션 시 예상치 못한 버그 대량 발생 가능

  (3) XML 기반 설정 지옥

  applicationContext.xml 
  action-servlet.xml
  web.xml
  datasource 설정 4개 (국가별)
  - 난이도: ⭐⭐⭐
  - Spring Boot로 변환 시 전체 재작성
  - Bean 의존성 파악 어려움

  ---
  3. 도메인 복잡도 (매우 높음 🔴)

  출입국 관리 시스템 특성:

  ✗ 항공 용어 복잡 (PNR, IAPP, LDCS, PFMS)
  ✗ 국가별 규정 상이 (KOR, TWN, ZA)
  ✗ 데이터 동기화 이슈
  ✗ 보안/규제 준수 필수
  ✗ 실시간 처리 요구

  가장 큰 문제:
  - 도메인 전문가 없으면 비즈니스 로직 이해 불가
  - 잘못 건드리면 국가 출입국 시스템 마비
  - 테스트 환경 구축도 복잡

  ---
  4. 데이터베이스 마이그레이션 (높음 🔴)

  동적 데이터소스 라우팅
  ├─ iAPP_KOR
  ├─ PNR_KOR (운영)
  ├─ PNR_KOR_TEST
  ├─ PNR_JPN (운영)
  ├─ PNR_JPN_TEST
  ├─ PFMS
  └─ 대만/남아공 별도 DB

  문제점:
  - 커스텀 DynamicRoutingDataSource 사용
  - 국가별 DB 스키마 다를 가능성
  - 트랜잭션 관리 복잡
  - Spring Boot의 표준 방식과 충돌

  ---
  5. 프론트엔드 현대화 (극악 🔴🔴)

  현재 구조:

  jQuery 3.6.0 기반
  ├─ 51개의 스파게티 JS 파일
  ├─ DataTables (테이블)
  ├─ jqPlot (차트)
  └─ AJAX 직접 호출

  React/Vue 전환 시:

  | 작업                    | 난이도   | 예상 기간 |
  |-----------------------|-------|-------|
  | 51개 JS → 컴포넌트화        | ⭐⭐⭐⭐⭐ | 3-6개월 |
  | DataTables → 현대 라이브러리 | ⭐⭐⭐   | 1개월   |
  | jqPlot → Chart.js/D3  | ⭐⭐⭐   | 1개월   |
  | API 분리 (REST 표준화)     | ⭐⭐⭐⭐  | 2개월   |

  문제:
  - HTML 템플릿과 JS가 강하게 결합
  - 전체를 한 번에 바꿔야 함 (점진적 어려움)

  ---
  6. 테스트 코드 부재 (치명적 💀)

  # 테스트 파일 검색
  find . -name "*Test*.java"  # 0개 예상

  리스크:
  - 리팩토링 시 회귀 버그 발견 불가
  - 수동 테스트만 가능
  - 배포 후 운영 환경에서 버그 발견

  ---
  7. 종합 난이도 평가

  시나리오별 난이도:

● | 현대화 수준                       | 난이도   | 예상 기간   | 위험도 |
  |------------------------------|-------|---------|-----|
  | 최소 (Java 17 + Spring Boot 3) | ⭐⭐⭐⭐  | 3-4개월   | 중   |
  | 중간 (+API 표준화)                | ⭐⭐⭐⭐  | 6-8개월   | 중상  |
  | 전체 (프론트 React/Vue 전환)        | ⭐⭐⭐⭐⭐ | 12-18개월 | 상   |

  ---
  8. 구체적인 어려움들

  (1) 즉시 마주칠 문제

  Week 1-2:
  ✗ Spring Boot 3.x는 Java 17 필수
    → Java 8 → 17 마이그레이션
    → deprecated API 대량 발생

  ✗ javax.* → jakarta.* 패키지 변경
    → 102개 파일 전체 수정

  ✗ web.xml 제거
    → Servlet 3.0+ 방식으로 재작성

  (2) 중반부 문제

  Week 3-8:
  ✗ iBatis 제거
    → MyBatis로 전환 (SQL 문법 호환성)
    → 23개 매퍼 재검증

  ✗ 동적 데이터소스 재구현
    → @Transactional과 충돌 가능
    → 멀티 DB 트랜잭션 이슈

  ✗ XML Bean → Java Config
    → 의존성 그래프 파악 필요

  (3) 후반부 문제

  Week 9-16:
  ✗ 통합 테스트 부재
    → 수동 QA 필수
    → 국가별 환경 테스트 (KOR, TWN, ZA)

  ✗ 운영 배포 리스크
    → 출입국 시스템 다운 불가
    → Blue-Green 배포 필요
    → 롤백 계획 필수

  ---
  9. 가장 위험한 부분 🚨

  동적 데이터소스 라우팅

  // 현재 방식 (커스텀)
  DynamicRoutingDataSource
  └─ ThreadLocal로 DB 선택

  // Spring Boot 표준 방식과 다름
  @Transactional이 제대로 작동 안 할 수 있음

  예상 문제:
  - 마이그레이션 중 데이터 정합성 깨질 위험
  - 트랜잭션 롤백 실패
  - 국가별 DB 분기 로직 오작동

  ---
  10. 현실적인 조언

  ✅ 점진적 접근 강력 추천

  Phase 1 (3개월): 최소 현대화

  11. Java 17 업그레이드
  12. Spring Boot 3 마이그레이션
  13. iBatis 제거 (MyBatis 통일)
  14. 테스트 코드 작성 시작
  - 난이도: ⭐⭐⭐⭐
  - 리스크: 관리 가능
  - 효과: 기술 부채 50% 해소

  Phase 2 (4개월): API 표준화

  1. REST API 재설계
  2. Controller 리팩토링
  3. 응답 포맷 표준화 (JSON)
  - 난이도: ⭐⭐⭐
  - 리스크: 낮음
  - 효과: 프론트 분리 준비

  Phase 3 (12개월): 프론트엔드

  1. React/Vue 전환
  2. 51개 JS 컴포넌트화
  3. 단계별 화면 전환
  - 난이도: ⭐⭐⭐⭐⭐
  - 리스크: 높음
  - 효과: 완전한 현대화

  ---
  11. 필요 리소스

  인력:

  - 백엔드 시니어: 1-2명 (Spring Boot 경험 필수)
  - 도메인 전문가: 1명 (항공/출입국 업무 이해)
  - QA: 1명 (국가별 테스트)
  - 프론트엔드: 1명 (Phase 3 시)

  시간:

  - 최소: 3-4개월 (백엔드만)
  - 전체: 12-18개월 (프론트 포함)

  비용:

  - 예상 인건비: 1억~3억 원 (규모에 따라)

  ---
  결론

  난이도: 8/10 ⭐⭐⭐⭐⭐⭐⭐⭐

  어려운 이유:
  1. ❌ 테스트 코드 없음
  2. ❌ 복잡한 도메인 (항공 출입국)
  3. ❌ 다중 레거시 기술 혼재
  4. ❌ 운영 중단 불가 (국가 인프라)
  5. ❌ 다국가 DB 동기화

  그래도 가능한 이유:
  6. ✅ 코드 구조는 비교적 체계적
  7. ✅ Spring 기반 (표준 프레임워크)
  8. ✅ 규모는 중소형
  9. ✅ 점진적 접근 가능

  ---
  추천 전략

  현실적인 접근:
  1단계: Spring Boot 3 + Java 17 (3개월)
     ↓
  2단계: 테스트 코드 작성 (2개월)
     ↓
  3단계: 운영 안정화 (1개월)
     ↓
  4단계: API 표준화 (3개월)
     ↓
  5단계: 프론트 현대화 검토

  한 번에 다 하려 하지 마세요 - 시스템 망가집니다 🚨

  도움이 필요하면 구체적인 Phase 1 마이그레이션 계획을 작성해드릴 수 있습니다!

-------------

● 아! 완전 새로 만들기? 🤔

  이게 사실 더 나은 선택일 수 있습니다!

  "Big Rewrite" 전략이라고 하는데, 장단점을 분석해드릴게요.

  ---
  ✅ 새로 만드는 게 나은 이유

  1. 훨씬 깔끔함

  레거시 고치기:
  ├─ iBatis 제거하다가 뭔가 깨짐
  ├─ XML 지우다가 Bean 의존성 오류
  ├─ 테스트 없어서 뭐가 깨졌는지 모름
  └─ 3개월 삽질 → 결과물은 여전히 지저분

  새로 만들기:
  ├─ Spring Boot 3 + Java 21
  ├─ JPA/MyBatis 깔끔하게
  ├─ React + TypeScript
  └─ 처음부터 테스트 코드 작성

  2. 현대 기술 100% 활용

  // 레거시 마이그레이션: 제약 많음
  - iBatis 흔적 남음
  - 구조는 여전히 2010년대
  - 반쪽짜리 현대화

  // 새로 만들기: 완전히 새 출발
  @SpringBootApplication
  public class EBorderApplication {
      // 완벽한 Spring Boot
      // Reactive Programming
      // Cloud Native
  }

  3. 개발 기간 비슷할 수 있음

  | 방식      | 예상 기간   | 품질           |
  |---------|---------|--------------|
  | 레거시 현대화 | 12-18개월 | ⭐⭐⭐ (타협의 산물) |
  | 새로 만들기  | 8-12개월  | ⭐⭐⭐⭐⭐ (깔끔함)  |

  왜?
  - 레거시 분석 시간 불필요
  - 디버깅 시간 대폭 감소
  - 의사결정 빠름

  ---
  ❌ 하지만 심각한 함정들

  1. "Second System Effect" - 두 번째 시스템 오류

  유명한 소프트웨어 엔지니어링 법칙

  개발자들이 새로 만들 때 저지르는 실수:

  "이번엔 완벽하게 만들자!"
  ├─ 과도한 추상화
  ├─ 필요없는 기능 추가
  ├─ 아키텍처 복잡해짐
  └─ 결국 더 엉망

  실제 사례:
  - Netscape 6: 완전 재작성 → 3년 걸림 → 그 사이 IE가 시장 장악 → 회사 망함
  - Windows Vista: 완전 재작성 → 실패

  2. 숨겨진 비즈니스 로직 놓침 🚨

  // 레거시 코드에 이런 게 있을 수 있음
  if (airline.equals("KE") && flight.startsWith("001")) {
      // 대한항공 001편은 특별 처리
      // 10년 전 항공청과 협의된 예외 규정
      // 문서화 안 됨
      specialProcess();
  }

  문제:
  - 새로 만들면 이런 로직을 못 찾음
  - 문서 없음 (코드가 문서)
  - 전임자 퇴사 → 아무도 모름
  - 운영 후 출입국 시스템 오작동

  3. 병렬 개발의 악몽

  현실:

  Month 1-6: 신규 시스템 개발 중
  ├─ 기존 시스템에 긴급 기능 추가 요청 → 넣어야 함
  ├─ 신규에도 반영해야 함
  └─ 점점 격차 벌어짐

  Month 7-12: 신규 완성
  ├─ 그런데 기존에 20개 기능 추가됨
  ├─ 신규에 또 넣어야 함
  └─ 영원히 끝나지 않음

  비용:
  - 기존 유지보수 인력: 2명
  - 신규 개발 인력: 4명
  - 총 6명 필요 (vs 점진적은 3명)

  4. 데이터 마이그레이션 지옥 💀

  -- 기존 DB
  iAPP_KOR: 1,000만 건
  PNR_KOR: 5,000만 건
  PNR_JPN: 2,000만 건
  PFMS: 3,000만 건

  -- 새 시스템으로 이관 시
  ✗ 스키마 다름 → 변환 스크립트 필요
  ✗ 참조 무결성 깨질 수 있음
  ✗ 운영 중단 불가 → 실시간 이관?
  ✗ 롤백 불가능

  최악의 시나리오:
  전환일 D-Day:
  00:00 - 데이터 마이그레이션 시작
  03:00 - 외래키 오류 발견
  05:00 - 긴급 수정
  07:00 - 업무 시작 시간
       - 시스템 안 됨
       - 공항 마비
       - 뉴스 1면

  5. 테스트 커버리지 확보 불가

  새 시스템 테스트:

  □ 한국 항공사 20개사 × 기능 50개 = 1,000 케이스
  □ 대만 항공사 10개사 × 기능 50개 = 500 케이스
  □ 남아공 ...

  현실적으로 불가능
  → 운영에서 버그 발견

  ---
  🎯 그럼 언제 새로 만들어야 하나?

  ✅ 새로 만들기 권장:

  1. 기존 시스템이 작을 때
    - 이 프로젝트: 102개 파일 → 작음 ✅
  2. 도메인이 단순할 때
    - 이 프로젝트: 출입국/항공 → 복잡 ❌
  3. 운영 중단 가능할 때
    - 이 프로젝트: 국가 인프라 → 불가 ❌
  4. 데이터가 적을 때
    - 이 프로젝트: 수천만 건 → 많음 ❌
  5. 비즈니스 로직이 명확할 때
    - 이 프로젝트: 문서 없음 → 불명확 ❌

  판정: 이 프로젝트는 위험함 ⚠️

  ---
  💡 현실적인 "하이브리드 전략"

  Strangler Fig Pattern (가장 추천!)

  기생식물이 기존 나무를 감싸며 서서히 대체하듯이

  Step 1: 신규 API 서버 구축 (병렬)
  ┌─────────────┐
  │ 기존 시스템  │ ← 그대로 운영
  └─────────────┘
         ↓
  ┌─────────────┐
  │ 새 API 서버  │ ← Spring Boot 3 + React
  └─────────────┘
    (기존 DB 공유)

  Step 2: 화면 하나씩 전환
  [로그인 화면] → 새 시스템
  [메인 대시보드] → 기존
  [IAPP 조회] → 기존
  ...

  Step 3: 3개월마다 화면 10개씩 전환
  12개월 후 → 새 시스템만 남음
  기존 시스템 셧다운

  구체적 예시:

  // nginx 라우팅
  location /api/v2/ {
      proxy_pass http://new-system:8080;  // 새 시스템
  }

  location / {
      proxy_pass http://legacy-system:8080;  // 기존 시스템
  }

  // 점진적으로 라우팅 변경
  // /api/v2/login → 새
  // /api/v2/iapp → 새
  // /api/v1/* → 기존 (언젠가 제거)

  장점:
  - ✅ 운영 중단 없음
  - ✅ 롤백 쉬움 (nginx 설정만 변경)
  - ✅ 위험 분산
  - ✅ 점진적 데이터 마이그레이션
  - ✅ 병렬 운영 부담 적음

  ---
  📊 3가지 전략 비교

  | 항목         | 점진적 현대화 | 완전 재작성   | Strangler Fig |
  |------------|---------|----------|---------------|
  | 개발 기간      | 12-18개월 | 8-12개월   | 12-15개월       |
  | 위험도        | ⭐⭐⭐     | ⭐⭐⭐⭐⭐    | ⭐⭐            |
  | 비용         | 중       | 높음       | 중상            |
  | 운영 중단      | 없음      | D-Day 있음 | 없음            |
  | 최종 품질      | ⭐⭐⭐     | ⭐⭐⭐⭐⭐    | ⭐⭐⭐⭐          |
  | 롤백         | 쉬움      | 거의 불가    | 매우 쉬움         |
  | 데이터 마이그레이션 | 불필요     | 일시에      | 점진적           |
  | 추천도        | ⭐⭐⭐     | ⭐        | ⭐⭐⭐⭐⭐         |

  ---
  🎯 최종 추천

  Strangler Fig 방식으로 새로 만들기

  Phase 1 (3개월): 인프라 구축
  ├─ Spring Boot 3 프로젝트 생성
  ├─ React 프로젝트 생성
  ├─ 기존 DB 연결 (공유)
  └─ nginx 라우팅 설정

  Phase 2 (3개월): 로그인 + 메인 화면
  ├─ 인증 시스템 (새)
  ├─ 대시보드 (새)
  ├─ 나머지는 iframe으로 기존 화면 표시
  └─ 사용자는 차이 모름

  Phase 3-6 (각 2개월): 모듈별 전환
  ├─ IAPP 화면 (새)
  ├─ PNR 화면 (새)
  ├─ LDCS 화면 (새)
  └─ 관리자 화면 (새)

  Phase 7 (1개월): 기존 시스템 종료
  └─ 레거시 서버 셧다운

  핵심 원칙:

  1. 기존 시스템 절대 건드리지 않음
  2. DB는 일단 공유 (나중에 분리)
  3. 화면 단위로 전환 (API 아님)
  4. 언제든 롤백 가능
  5. 사용자는 모름 (점진적)

  ---
  결론

  질문: "왜 그대로 두고 새로 만들면 안 돼?"

  답: 가능하지만, Strangler Fig 방식으로!

  - ❌ 한 번에 전체 재작성: 위험함 (Netscape의 전철)
  - ✅ 병렬로 새로 만들고 점진적 전환: 안전함

  이 방식의 성공 사례:
  - Netflix: Monolith → Microservices (5년 걸림)
  - Amazon: 2000년대 점진적 전환
  - Shopify: Rails 레거시 → 현대화 (진행 중)

  ---
  더 구체적인 Strangler Fig 구현 계획이 필요하면 작성해드릴게요! 🚀
