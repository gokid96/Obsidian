## EDIFACT PAXLST 전체 세그먼트 규칙

---

### **0. UNA (Service String Advice) - 구분자 선언** ⭐ 선택적

```
UNA:+.? '
```

**위치:** 메시지 **최상단** (있는 경우 반드시 첫 번째)

**구조:** 정확히 **9자**

```
UNA:+.? '
   123456789
```

|위치|문자|의미|
|---|---|---|
|1-3|UNA|세그먼트 태그 (고정)|
|4|`:`|컴포넌트 구분자|
|5|`+`|데이터 요소 구분자|
|6|`.`|소수점 표기|
|7|`?`|릴리스/이스케이프 문자|
|8||예약 (공백)|
|9|`'`|세그먼트 종료자|

**규칙:**

- 선택적이지만, 있으면 **반드시 첫 번째**
- 정확히 9자여야 함
- UNT 세그먼트 카운트에 **포함되지 않음**
- 없으면 표준 구분자 사용 가정

**예시:**

```
UNA:+.? '
UNA;*,? '  (다른 구분자 사용)
```

---

### **1. UNB (Interchange Header) - 인터체인지 헤더**  필수

```
UNB+구문식별자+송신자+수신자+날짜시간+제어번호+수신자참조+애플리케이션참조+우선순위+승인요청+협약ID+테스트지시자'
```

**위치:** UNA 다음 (또는 메시지 첫 번째)

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|구문식별자|⭐|식별자:버전|UNOA:4|
|2|송신자|⭐|ID:한정자|IPORT:ZZ|
|3|수신자|⭐|ID:한정자|KIS:ZZ|
|4|날짜/시간|⭐|YYMMDD:HHMM|251011:0957|
|5|제어번호|⭐|문자열(14)|2510110957|
|6|수신자참조|선택|문자열(14)||
|7|애플리케이션참조|선택|문자열(14)|APIS|
|8|우선순위|선택|코드(1)||
|9|승인요청|선택|코드(1)||
|10|협약ID|선택|문자열(35)||
|11|테스트지시자|선택|코드(1)|1|

**규칙:**

- 처음 5개 요소는 **필수**
- 구문식별자: `UNOA:4` (ASCII, 레벨4)
- 한정자: `ZZ`=상호정의, `14`=EAN, `01`=DUNS
- UNT 카운트에 **포함되지 않음**

**예시:**

```
UNB+UNOA:4+AQ:ZZ+KIS:ZZ+251011:0957+2510110957'
UNB+UNOA:4+AQ:ZZ+KIS:ZZ+251011:0957+2510110957++APIS'
UNB+UNOA:4+AQ:ZZ+KIS:ZZ+251011:0957+2510110957++++++1'  (테스트)
```

---

### **2. UNG (Functional Group Header) - 기능 그룹 헤더**  선택적

```
UNG+메시지타입+송신자+수신자+날짜시간+그룹참조+제어기관+메시지버전'
```

**위치:** UNB 다음

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|메시지타입|⭐|코드(6)|PAXLST|
|2|송신자|⭐|ID:한정자|AQ:ZZ|
|3|수신자|⭐|ID:한정자|KIS:ZZ|
|4|날짜/시간|⭐|YYMMDD:HHMM|251011:0957|
|5|그룹참조|⭐|문자열(14)|2510110957|
|6|제어기관|⭐|코드(2)|UN|
|7|메시지버전|⭐|버전:릴리스:코드|D:05B|

**규칙:**

- UNG 사용 시 UNE **필수**
- 제어기관: `UN`=UN/EDIFACT, `IA`=IATA
- 버전: `D`=Draft, `S`=Standard
- UNT 카운트에 **포함되지 않음**

**예시:**

```
UNG+PAXLST+AQ:ZZ+KIS:ZZ+251011:0957+2510110957+UN+D:05B'
UNG+CUSRES+KIS:ZZ+AQ:ZZ+251011:0958+2510110958+UN+D:05B'
```

---

### **3. UNH (Message Header) - 메시지 헤더** 필수

```
UNH+메시지참조번호+메시지식별자+공통참조+상태+하위집합'
```

**위치:** 메시지 시작 (UNG 다음 또는 UNB 다음)

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|메시지참조번호|⭐|문자열(14)|-|PAX001|
|2|메시지식별자|⭐|복합(6개)|타입:버전:릴리스:기관:코드:개정|PAXLST:D:05B:UN:IATA|
|3|공통접근참조|선택|문자열(35)|-||
|4|상태|선택|복합(2개)|시퀀스:첫/마지막|01:F|
|5|하위집합|선택|복합(4개)|ID:버전:릴리스||

**규칙:**

- **최대 5개 요소만 허용** (6번째부터 구문 오류)
- 메시지식별자 하위요소: 타입:버전:릴리스:기관:코드:개정
- 추가 참조는 **RFF 세그먼트** 사용
- UNT 카운트에 **포함** (카운트=1)

**예시:**

```
UNH+PAX001+PAXLST:D:05B:UN:IATA'
UNH+1+PAXLST:D:05B:UN:IATA'
UNH+PAX001+PAXLST:D:05B:UN:IATA++01:F'  (상태 포함)
```

❌ **잘못된 예:**

```
UNH+1+PAXLST:D:05B:UN:IATA+AQ2000+01:F'  (6-7번째 요소 - 오류!)
```

---

### **4. BGM (Beginning of Message) - 메시지 시작** ⭐ 필수

```
BGM+문서명+문서번호+메시지기능+응답타입'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|문서명|⭐|복합(4개)|코드:번호:버전:개정|745|
|2|문서번호|선택|문자열(35)|-|AQ7045251011|
|3|메시지기능|선택|코드(3)|-|9|
|4|응답타입|선택|코드(3)|-||

**문서명 코드:**

|코드|의미|
|---|---|
|`745`|Passenger List Message|
|`962`|Response (응답)|

**메시지 기능 코드:**

|코드|의미|
|---|---|
|`9`|Original (원본)|
|`5`|Replace (교체)|
|`1`|Cancellation (취소)|
|`4`|Change (변경)|

**예시:**

```
BGM+745'
BGM+745+AQ7045251011+9'
BGM+745++9'
BGM+962'  (응답 메시지)
```

---

### **5. RFF (Reference) - 참조정보**

```
RFF+한정자:참조번호:라인번호:참조버전:개정번호'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|참조|⭐|복합(5개)|한정자:번호:라인:버전:개정|TN:100000014876415|

**주요 한정자:**

|한정자|의미|형식|
|---|---|---|
|`TN`|Ticket Number|13자리 숫자|
|`AVF`|PNR/Booking Reference|6-7자|
|`SEA`|Seat Number|2-3자|
|`ABO`|Sender's Reference|문자열|
|`AON`|Flight Number|항공사+숫자|

**규칙:**

- 첫 번째 하위요소(한정자)는 **필수**
- 티켓번호: 앞 3자리=항공사, 나머지 10자리=번호
- 빈 요소는 `:::`으로 표현

**예시:**

```
RFF+TN:100000014876415'
RFF+TN:100000014876415:::1'  (개정번호 포함)
RFF+AVF:2392G8'
RFF+SEA:7A'
RFF+AON:AQ7045'
RFF+ABO:64885E52'
```

❌ **잘못된 예:**

```
RFF+TN:100000014876415KWE:::001'  (참조번호와 다른 값 붙음)
```

---

### **6. NAD (Name and Address) - 이름 및 주소**

```
NAD+한정자+당사자ID+당사자주소+당사자명+거리+도시+주/지역+우편번호+국가'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|당사자한정자|⭐|코드(3)|-|FL|
|2|당사자ID|선택|복합(3개)|ID:리스트:기관||
|3|당사자주소|선택|복합(5개)|주소1:2:3:4:5||
|4|당사자명|선택|복합(5개)|성:이름:미들:타이틀:이니셜|SMITH:JOHN|
|5-9|거리/도시/주/우편/국가|선택||||

**당사자 한정자:**

|코드|의미|
|---|---|
|`FL`|Flight Passenger (승객)|
|`MS`|Message Sender (발신자)|

**당사자명 하위요소:**

|순서|의미|예시|
|---|---|---|
|1|성(Surname)|SMITH|
|2|이름(Given Name)|JOHN|
|3|미들네임|WILLIAM|
|4|타이틀|MR, MS, DR|
|5|이니셜|JW|

**규칙:**

- 이름 순서: **성:이름** (슬래시 아님)
- 빈 요소는 `+++`로 표현

**예시:**

```
NAD+FL+++SMITH:JOHN'
NAD+FL+++LEHNER:TESSA'
NAD+FL+++KIM:MINGYU'
NAD+FL+++SMITH:JOHN::MR'  (타이틀 포함)
NAD+MS+++RES2 SUPPORT'  (회사명)
```

---

### **7. ATT (Attribute) - 속성정보**

```
ATT+한정자+속성기능+속성상세'
```

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|속성타입한정자|⭐|코드(3)|2|
|2|속성기능|선택|복합(2개)||
|3|속성상세|선택|복합(3개)|M|

**속성타입:**

|코드|의미|
|---|---|
|`2`|Characteristic (성별/승객타입)|

**속성값:**

|코드|의미|
|---|---|
|`M`|Male (남성)|
|`F`|Female (여성)|
|`I`|Infant (유아, 0-2세)|
|`C`|Child (아동, 2-12세)|

**예시:**

```
ATT+2++M'  (남성)
ATT+2++F'  (여성)
ATT+2++I'  (유아)
```

---

### **8. DTM (Date/Time/Period) - 날짜/시간**

```
DTM+한정자:날짜시간:형식코드'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|날짜/시간/기간|⭐|복합(3개)|한정자:값:형식|189:2510111800:201|

**날짜/시간 한정자:**

|코드|의미|
|---|---|
|`189`|Departure Date/Time (출발)|
|`232`|Arrival Date/Time (도착)|
|`329`|Date of Birth (생년월일)|
|`36`|Expiry Date (만료일)|

**형식 코드:**

|코드|형식|예시|
|---|---|---|
|`102`|CCYYMMDD|19960625|
|`201`|CCYYMMDDHHMM|202510111800|
|`203`|CCYYMMDDHHMMSS|20251011180000|

**규칙:**

- 세 하위요소 **모두 필수**
- 형식코드 생략 불가

**예시:**

```
DTM+189:202510111800:201'  (출발: 2025-10-11 18:00)
DTM+232:202510112130:201'  (도착: 2025-10-11 21:30)
DTM+329:19960625:102'      (생년월일: 1996-06-25)
DTM+36:20260906:102'       (만료일: 2026-09-06)
```

---

### **9. MEA (Measurements) - 측정값** 선택적

```
MEA+측정적용한정자+측정차원:측정의의+측정값:측정단위'
```

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|측정적용한정자|⭐|코드(3)|PD|
|2|측정차원|선택|복합(2개)|HT, WT|
|3|측정값|선택|복합(2개)|값:단위|

**측정 차원:**

|코드|의미|
|---|---|
|`HT`|Height (키)|
|`WT`|Weight (몸무게)|

**예시:**

```
MEA+PD+HT+180:CMT'  (키: 180cm)
MEA+PD+WT+75:KGM'   (몸무게: 75kg)
```

---

### **10. LOC (Place/Location Identification) - 위치/장소**

```
LOC+한정자+위치식별+관련위치+관계'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|위치한정자|⭐|코드(3)|-|125|
|2|위치식별|선택|복합(4개)|코드:리스트:기관:명칭|ICN|

**위치 한정자:**

|코드|의미|
|---|---|
|`5`|Place of Loading (적재지)|
|`22`|Place of Residence (거주지)|
|`87`|Place of Arrival (도착지)|
|`91`|Country of Issue (발급국가)|
|`125`|Place of Departure (출발지)|
|`174`|Country of Birth (출생국가)|
|`178`|Port of Embarkation (탑승지)|
|`179`|Port of Disembarkation (하차지)|
|`180`|Place of Transit (경유지)|

**주요 공항 코드 (IATA):**

|코드|공항명|
|---|---|
|`ICN`|인천|
|`KWE`|귀양|
|`AMS`|암스테르담|
|`PEK`|베이징|
|`NRT`|나리타|

**국가 코드 (ISO 3166-1 alpha-3):**

|코드|국가|
|---|---|
|`KOR`|대한민국|
|`CHN`|중국|
|`JPN`|일본|
|`USA`|미국|
|`MNG`|몽골|

**예시:**

```
LOC+125+ICN'     (출발지: 인천)
LOC+87+AMS'      (도착지: 암스테르담)
LOC+178+ICN'     (탑승지)
LOC+179+AMS'     (하차지)
LOC+180+PEK'     (경유지)
LOC+91+CHN'      (발급국: 중국)
LOC+22+SEL'      (거주지: 서울)
```

---

### **11. NAT (Nationality) - 국적**

```
NAT+한정자+국적코드'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|한정자|⭐|코드(3)|-|2|
|2|국적|선택|복합(3개)|코드:리스트:기관|CHN|

**한정자:**

|코드|의미|
|---|---|
|`2`|Nationality (국적)|

**규칙:**

- ISO 3166-1 alpha-3 (3자) 권장
- ISO 3166-1 alpha-2 (2자) 허용

**예시:**

```
NAT+2+CHN'  (중국)
NAT+2+KOR'  (한국)
NAT+2+MNG'  (몽골)
NAT+2+JPN'  (일본)
```

---

### **12. DOC (Document/Message Details) - 문서 상세**

```
DOC+문서타입+문서번호+문서상태+문서출처'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|문서명|⭐|복합(4개)|타입:수량:상태:출처|P:110:111|
|2|문서번호|선택|복합(4개)|번호:발급일:위치|EH5750437|

**문서 타입:**

|코드|의미|
|---|---|
|`P`|Passport (여권)|
|`V`|Visa (비자)|
|`I`|Identity Card (신분증)|
|`C`|Crew Member Certificate (승무원증)|

**문서 수량:**

|코드|의미|
|---|---|
|`110`|Copy (사본)|
|`120`|Original (원본)|

**문서 상태:**

|코드|의미|
|---|---|
|`111`|Document (문서)|
|`345`|Temporary (임시)|

**예시:**

```
DOC+P+EH5750437'              (여권)
DOC+P:110:111+EH5750437'      (여권 사본)
DOC+V+VISA123456'             (비자)
DOC+I+ID987654321'            (신분증)
DOC+C+CREW12345'              (승무원증)
```

---

### **13. TDT (Details of Transport) - 운송 상세**

```
TDT+운송단계+운송편명+운송수단+운항사+운송소유자'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|운송단계|⭐|코드(3)|-|20|
|2|운송편명|선택|문자열(17)|-|AQ7045|
|3|운송수단식별|선택|복합(4개)|ID:타입:항공사:국적||
|4|운송수단|선택|복합(2개)|타입:설명||
|5|운항사|선택|복합(4개)|코드:리스트:기관:명칭|AQ|

**운송단계:**

|코드|의미|
|---|---|
|`10`|Pre-Carriage (사전 운송)|
|`20`|Main Carriage (주 운송)|
|`30`|On-Carriage (후속 운송)|

**기종 코드 (3번 요소 두 번째 하위):**

|코드|기종|
|---|---|
|`788`|Boeing 787-8|
|`359`|Airbus A350-900|
|`77W`|Boeing 777-300ER|

**주요 항공사 코드:**

|코드|항공사|
|---|---|
|`KE`|대한항공|
|`OZ`|아시아나항공|
|`AQ`|에어아시아|

**예시:**

```
TDT+20+AQ7045+++AQ'
TDT+20+KE0123+++KE'
TDT+20+AQ7045+HL7777:788+++AQ'  (기체정보 포함)
```

---

### **14. COM (Communication Contact) - 연락처** 선택적

```
COM+통신번호:통신채널한정자'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|통신채널|⭐|복합(2개)|번호:채널타입|번호:TE|

**통신 채널 타입:**

|코드|의미|
|---|---|
|`TE`|Telephone (전화)|
|`FX`|Fax (팩스)|
|`EM`|Email (이메일)|
|`TM`|Mobile Phone (휴대폰)|

**예시:**

```
COM+82-10-1234-5678:TE'
COM+0031 85 130 3661:TE'
COM+email@example.com:EM'
```

---

### **15. EMP (Employment Details) - 고용 정보** 선택적 (승무원용)

```
EMP+고용한정자+직급:코드리스트한정자'
```

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|고용한정자|⭐|코드(3)|4|
|2|직급|선택|복합(2개)|CA, CP|

**직급 코드:**

|코드|의미|
|---|---|
|`CP`|Captain (기장)|
|`FO`|First Officer (부기장)|
|`CA`|Cabin Attendant (객실승무원)|
|`PU`|Purser (사무장)|

**예시:**

```
EMP+4+CA'  (객실승무원)
EMP+4+CP'  (기장)
```

---

### **16. CNT (Control Total) - 제어 합계**

```
CNT+제어한정자:제어값:측정단위'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|제어|⭐|복합(3개)|한정자:값:단위|42:1|

**제어 한정자:**

|코드|의미|
|---|---|
|`42`|Number of Passengers (승객 수)|
|`7`|Number of Crew (승무원 수)|

**예시:**

```
CNT+42:1'    (승객 1명)
CNT+42:157'  (승객 157명)
CNT+7:10'    (승무원 10명)
```

---

### **17. ERC (Application Error) - 애플리케이션 오류** (CUSRES 응답용)

```
ERC+애플리케이션오류코드'
```

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|오류코드|⭐|코드(3)|4|

**오류 코드:**

|코드|의미|
|---|---|
|`2`|Syntax version not supported|
|`4`|Conditional required element missing|
|`12`|Value too long|
**예시:**
```
ERC+4'   (조건부 필수 요소 누락)
ERC+12'  (값이 너무 김)
```

---

### **18. FTX (Free Text) - 자유 텍스트**

```
FTX+텍스트주제한정자+텍스트기능코드+텍스트참조+텍스트'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|텍스트주제한정자|⭐|코드(3)|-|AAO|
|2|텍스트기능코드|선택|코드(3)|-||
|3|텍스트참조|선택|복합(2개)|-||
|4|텍스트|선택|복합(5개)|텍스트1:2:3:4:5|DATA NOT FOUND|

**텍스트 주제 한정자:**

|코드|의미|
|---|---|
|`AAO`|Description (설명)|
|`AAH`|Error Description (오류 설명)|
|`AAI`|General Information (일반 정보)|

**예시:**

```
FTX+AAO+++DATA NOT FOUND'
FTX+AAH+++50 Syntax error - UN/EDIFACT'
FTX+AAI+++PASSENGER ACCEPTED'
```

---

### **19. ERP (Error Point Details) - 오류 지점 상세** (CUSRES 응답용)

```
ERP+오류지점:오류컴포넌트:오류요소위치'
```

|위치|요소명|필수|형식|복합요소|예시|
|---|---|---|---|---|---|
|1|오류지점|선택|복합(4개)|세그먼트:요소:컴포넌트:반복|1|

**오류지점 하위요소:**

|순서|의미|예시|
|---|---|---|
|1|세그먼트 위치|1 (첫 번째 세그먼트)|
|2|데이터 요소 위치|2 (두 번째 요소)|
|3|컴포넌트 위치|3 (세 번째 컴포넌트)|

**예시:**

```
ERP+1'        (첫 번째 세그먼트)
ERP+5:2'      (5번째 세그먼트, 2번째 요소)
ERP+12:3:2'   (12번째 세그먼트, 3번째 요소, 2번째 컴포넌트)
```

---

### **20. UNT (Message Trailer) - 메시지 트레일러** ⭐ 필수

```
UNT+세그먼트수+메시지참조번호'
```

**위치:** 메시지 끝

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|세그먼트 수|⭐|숫자(6)|22|
|2|메시지참조번호|⭐|문자열(14)|PAX001|

**규칙:**

- **세그먼트 수:** UNH부터 UNT까지 **모든 세그먼트** 포함 (UNT 자신 포함)
- **제외:** UNA, UNB, UNG, UNE, UNZ
- **참조번호:** UNH의 참조번호와 **정확히 동일**해야 함
- UNT는 카운트에 **포함됨**

**카운트 예시:**

```
UNH+PAX001+PAXLST:D:05B:UN:IATA'    <- 1
BGM+745'                             <- 2
RFF+TN:100000014876415'              <- 3
...
CNT+42:1'                            <- 21
UNT+22+PAX001'                       <- 22
```

**예시:**

```
UNT+22+PAX001'
UNT+23+1'
```

---

### **21. UNE (Functional Group Trailer) - 기능 그룹 트레일러** (UNG 사용 시 필수)

```
UNE+메시지수+그룹참조번호'
```

**위치:** UNT 다음 (그룹 끝)

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|메시지 수|⭐|숫자(6)|1|
|2|그룹참조번호|⭐|문자열(14)|2510110957|

**규칙:**

- **메시지 수:** 해당 그룹 내 UNH/UNT 쌍의 개수
- **참조번호:** UNG의 참조번호와 **정확히 동일**해야 함
- UNG가 있으면 UNE **필수**
- UNT 카운트에 **포함되지 않음**

**예시:**

```
UNG+PAXLST+AQ:ZZ+KIS:ZZ+251011:0957+2510110957+UN+D:05B'
  UNH...UNT  (메시지 1)
  UNH...UNT  (메시지 2)
UNE+2+2510110957'  (메시지 2개)
```

---

### **22. UNZ (Interchange Trailer) - 인터체인지 트레일러** ⭐ 필수

```
UNZ+그룹수+인터체인지참조번호'
```

**위치:** 메시지 **최하단** (마지막)

|위치|요소명|필수|형식|예시|
|---|---|---|---|---|
|1|그룹 수|⭐|숫자(6)|1|
|2|인터체인지참조번호|⭐|문자열(14)|2510110957|

**규칙:**

- **그룹 수:** UNG/UNE 쌍의 개수 (UNG 없으면 메시지 수)
- **참조번호:** UNB의 참조번호와 **정확히 동일**해야 함
- UNT 카운트에 **포함되지 않음**

**예시:**

```
UNB+UNOA:4+AQ:ZZ+KIS:ZZ+251011:0957+2510110957'
  UNG...UNE  (그룹 1)
  UNG...UNE  (그룹 2)
UNZ+2+2510110957'  (그룹 2개)
```

**UNG 없는 경우:**

```
UNB+UNOA:4+AQ:ZZ+KIS:ZZ+251011:0957+2510110957'
  UNH...UNT  (메시지)
UNZ+1+2510110957'  (메시지 1개)
```

---

##  **전체 메시지 구조 요약**

```
[UNA:+.? ']                        <- 선택적, 카운트 제외
UNB+...                            <- 필수, 카운트 제외
  [UNG+...]                        <- 선택적, 카운트 제외
    UNH+...                        <- 필수, 카운트 1
      BGM+...                      <- 필수, 카운트 2
      RFF+...                      <- 선택적
      NAD+...                      <- 선택적
      TDT+...                      <- 선택적
      LOC+...                      <- 선택적
      DTM+...                      <- 선택적
      ...
      --- 승객 그룹 (반복 가능) ---
      NAD+FL+...                   <- 승객 이름
        ATT+...                    <- 성별
        DTM+329+...                <- 생년월일
        LOC+178+...                <- 탑승지
        LOC+179+...                <- 하차지
        NAT+...                    <- 국적
        RFF+AVF+...                <- PNR
        RFF+SEA+...                <- 좌석
        DOC+...                    <- 여권
        DTM+36+...                 <- 여권만료일
        LOC+91+...                 <- 발급국
      --- 승객 그룹 끝 ---
      CNT+...                      <- 승객 수
    UNT+n+...                      <- 필수, 카운트 포함
  [UNE+...]                        <- UNG 사용 시 필수, 카운트 제외
UNZ+...                            <- 필수, 카운트 제외
```

---

## ⚠️ **핵심 규칙 요약**

### **1. 세그먼트 카운트**

|세그먼트|UNT 카운트 포함 여부|
|---|---|
|UNA|❌ 제외|
|UNB|❌ 제외|
|UNG|❌ 제외|
|UNH|✅ 포함 (1번)|
|BGM, RFF, NAD 등|✅ 포함|
|UNT|✅ 포함 (마지막)|
|UNE|❌ 제외|
|UNZ|❌ 제외|

### **2. 참조번호 일치 규칙**

|세그먼트 쌍|일치해야 할 참조번호|
|---|---|
|UNH ↔ UNT|메시지 참조번호|
|UNG ↔ UNE|그룹 참조번호|
|UNB ↔ UNZ|인터체인지 참조번호|

### **3. 필수 세그먼트**

|세그먼트|필수 여부|
|---|---|
|UNB|⭐ 필수|
|UNG|선택적|
|UNH|⭐ 필수|
|BGM|⭐ 필수|
|UNT|⭐ 필수|
|UNE|UNG 사용 시 필수|
|UNZ|⭐ 필수|

### **4. 구분자**

|구분자|기본값|의미|
|---|---|---|
|세그먼트 종료|`'`|세그먼트 끝|
|데이터 요소|`+`|요소 구분|
|컴포넌트|`:`|하위요소 구분|
|릴리스 문자|`?`|특수문자 이스케이프|

### **5. 빈 요소 표현**

```
NAD+FL+++SMITH:JOHN'
      ││ └─ 4번 요소
      │└─── 3번 요소 (빈 값)
      └──── 2번 요소 (빈 값)

DTM+329:960625::
           ││└─ 빈 값
           │└── 빈 값
           └─── 값
```

### **6. 중요 제한사항**

- **UNH:** 최대 5개 데이터 요소만 허용 (6번째부터 오류)
- **구분자 사용 금지:** 데이터 내에서 `'`, `+`, `:` 사용 시 릴리스 문자(`?`) 필요
- **날짜 형식:** 항상 형식코드 명시 필수
- **참조번호:** 대소문자 구분, 정확히 일치

---

## 🎯 **완전한 PAXLST 메시지 예시**

```
UNA:+.? '
UNB+UNOA:4+AQ:ZZ+KIS:ZZ+251011:0957+2510110957++KIS'
UNG+PAXLST+AQ:ZZ+KIS:ZZ+251011:0957+2510110957+UN+D:05B'
UNH+PAX001+PAXLST:D:05B:UN:IATA'
BGM+745'
RFF+TN:100000014876415'
TDT+20+AQ7045+++AQ'
LOC+125+KWE'
DTM+189:2510111800:201'
LOC+87+ICN'
DTM+232:2510112130:201'
NAD+FL+++LEHNER:TESSA'
ATT+2++M'
DTM+329:960625:102'
LOC+178+KWE'
LOC+179+ICN'
NAT+2+CHN'
RFF+AVF:2392G8'
RFF+SEA:7A'
DOC+P:110:111+EH5750437'
DTM+36:260906:102'
LOC+91+CHN'
CNT+42:1'
UNT+22+PAX001'
UNE+1+2510110957'
UNZ+1+2510110957'
```

---

## 🔍 **원본 메시지 오류 분석**

**원본:**

```
UNH+1+PAXLST:D:05B:UN:IATA+AQ2000+01:F'
```

**오류:**

- 6번째 요소: `AQ2000` ❌
- 7번째 요소: `01:F` ❌
- UNH는 최대 **5개 요소**만 허용

**수정:**

```
UNH+1+PAXLST:D:05B:UN:IATA'
RFF+AON:AQ2000'
RFF+MSN:01:F'
```

또는

```
UNH+1+PAXLST:D:05B:UN:IATA++01:F'
    │ │                    ││
    │ │                    │└─ 상태 (5번 요소 사용)
    │ │                    └── 공통참조 빈 값 (3번 요소)
    │ └──────────────────────── 메시지식별자 (2번 요소)
    └────────────────────────── 참조번호 (1번 요소)
```