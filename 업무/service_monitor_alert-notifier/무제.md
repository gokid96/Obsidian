31번서버
docker
```liux
ea5dc74679ed   gitea.yhtdev.net/eborder/service-monitor:latest   "ruby serviceMonitor…"   2 weeks ago   Up 7 days   0.0.0.0:1112->1112/tcp                                           service-monitor

259f71ed68e5   gitea.yhtdev.net/eborder/alert-notifier:latest    "ruby lib/alertNotif…"   2 weeks ago   Up 8 days   0.0.0.0:6277->5277/tcp                                           alert-notifier
```
 
## 전체 시스템 구조
````ruby
postgres = configuration["Postgresql"]
database = Sequel.connect(
  host: postgres.fetch("HostName"),  # 192.168.14.31
  # ...
)
# PostgreSQL에 연결해서 알람 조회
```

**동작 방식:**
- 31번 서버의 PostgreSQL DB에 연결
- `arinc_integrator_alarms` 테이블에서 미해결 알람 조회
- 5분 이상 된 알람들을 리포트

## 전체 아키텍처
```
┌─────────────────────────────────────────────────┐
│  각 원격 서버 (21, 22, 23, 11, 12번 등)           │
│  ├── 자체 service-monitor                        │
│  │   ├── 로컬 모니터링                            │
│  │   └── 자신의 이벤트를 alert-notifier로 전송     │
│  └── health check 클라이언트                      │
│      └── 31번:1112로 상태 보고                    │
└────────────┬────────────────────────────────────┘
             │ TCP 연결 (port 1112)
             ▼
┌─────────────────────────────────────────────────┐
│  31번 서버 (USTD-DEV1-31, mercury-dev)          │
│  ┌───────────────────────────────────────┐      │
│  │ service-monitor 컨테이너               │      │
│  │ ├── serverConnectionCheck.rb          │      │
│  │ │   ├── 1112 포트 LISTEN               │      │
│  │ │   ├── 원격 서버들에 연결 시도         │      │
│  │ │   └── 원격 서버들의 연결 수신         │      │
│  │ ├── commonContainerCheck.rb           │      │
│  │ │   └── 31번 로컬 컨테이너 체크         │      │
│  │ └── amrAlarmCheck.rb                  │      │
│  │     └── PostgreSQL DB 알람 조회        │      │
│  └───────────┬───────────────────────────┘      │
│              │ TCP Socket (port 5277)           │
│              ▼                                   │
│  ┌───────────────────────────────────────┐      │
│  │ alert-notifier 컨테이너                │      │
│  │ ├── TCP 5277 포트 LISTEN               │      │
│  │ ├── 모든 서버의 이벤트 수신             │      │
│  │ ├── 이벤트 타입별 분류                  │      │
│  │ └── SMTP 이메일 발송                   │      │
│  └───────────────────────────────────────┘      │
│                                                  │
│  ┌───────────────────────────────────────┐      │
│  │ PostgreSQL (port 5010)                │      │
│  │ └── arinc_integrator_alarms 테이블     │      │
│  └───────────────────────────────────────┘      │
└──────────────────────────────────────────────────┘
```

## 로그 분석 결과
```
ServiceName: "USTD-DEV1-31"     # 31번 서버의 service-monitor가 생성
ServiceName: "PNR-PROD1"        # 21번 서버의 service-monitor가 생성
ServiceName: "KOR-APP-PROD2"    # 12번 서버의 service-monitor가 생성
ServiceName: "DC-MONITOR-DOCKER" # 다른 서버의 service-monitor가 생성
````


