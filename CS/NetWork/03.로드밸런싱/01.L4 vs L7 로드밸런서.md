
## 로드밸런싱이란?

여러 서버에 트래픽을 분산하여 가용성과 성능을 높이는 기술

```
           ┌─────────────┐
           │ Load        │
Client ───▶│ Balancer    │───┬──▶ Server 1
           │             │   ├──▶ Server 2
           └─────────────┘   └──▶ Server 3
```

## L4 로드밸런서 (Transport Layer)

- **동작 계층**: TCP/UDP (전송 계층)
- **판단 기준**: IP 주소, Port 번호
- **특징**:
    - 패킷 내용을 보지 않음 (빠름)
    - 단순한 분산
    - NAT 방식으로 동작

```
Client → L4 LB → 목적지 IP:Port 기준으로 분산
```

## L7 로드밸런서 (Application Layer)

- **동작 계층**: HTTP/HTTPS (응용 계층)
- **판단 기준**: URL, Header, Cookie, 요청 내용
- **특징**:
    - 패킷 내용 분석 (상대적으로 느림)
    - 세밀한 라우팅 가능
    - SSL Termination 가능

```
Client → L7 LB → /api/* → API 서버
                 /static/* → 정적 파일 서버
                 Cookie: session=abc → 특정 서버 (Sticky)
```

## 비교표

|구분|L4|L7|
|---|---|---|
|속도|빠름|상대적으로 느림|
|판단 기준|IP, Port|URL, Header, Cookie|
|SSL 처리|불가 (Pass-through)|가능 (Termination)|
|세션 유지|IP 해시로 가능|Cookie 기반 Sticky|
|비용|저렴|상대적으로 비쌈|

## 구성 예시

```
                    ┌─── Web Server 1
        ┌─ L7 LB ───┼─── Web Server 2
        │   (nginx) └─── Web Server 3
Client ─┤
        │
        └─ L4 LB ───┬─── DB Primary
           (HAProxy)└─── DB Replica
```