
Config Server는 **여러 서비스의 설정을 한 곳에서 관리하는 서버**
Spring Cloud Config, Consul, AWS Parameter Store 등으로 구현

---

## 왜 필요한가

**Config Server 없이:**

```
order-service/application.yml   → DB 접속 정보
payment-service/application.yml → DB 접속 정보 (중복)
delivery-service/application.yml → DB 접속 정보 (중복)
```

- 설정 변경 시 모든 서비스 수정 + 재배포
- 환경별(dev, prod) 설정 관리 복잡
- 민감 정보가 코드에 포함

**Config Server 있으면:**

```
┌─────────────┐
│Config Server│ ← 설정 중앙 저장
└──────┬──────┘
       │
  ┌────┼────┬────────┐
  ▼    ▼    ▼        ▼
 order payment delivery ...
```

- 설정 한 곳에서 관리
- 서비스 재배포 없이 설정 변경 가능
- 민감 정보 암호화

---

## 구조

```
┌──────────────┐      ┌─────────────┐
│ Config Server│ ←──  │ Git / Vault │  ← 설정 저장소
└──────┬───────┘      └─────────────┘
       │
       │  설정 조회
       ▼
┌─────────────┐
│  Services   │
└─────────────┘
```

---

## 코드 예시 (Spring Cloud Config)

**Config Server**
```java
@SpringBootApplication
@EnableConfigServer
public class ConfigServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(ConfigServerApplication.class, args);
    }
}
```

```yaml
# Config Server application.yml
spring:
  cloud:
    config:
      server:
        git:
          uri: https://github.com/my-org/config-repo
```

**Config Client (각 서비스)**

```yaml
# bootstrap.yml
spring:
  application:
    name: order-service
  cloud:
    config:
      uri: http://config-server:8888
```

---

## 설정 저장소 구조
```
config-repo/
├── application.yml          # 공통 설정
├── order-service.yml        # order-service 전용
├── order-service-dev.yml    # order-service 개발 환경
├── order-service-prod.yml   # order-service 운영 환경
└── payment-service.yml
````

---

## 설정 갱신

**방법 1: 서비스 재시작**

**방법 2: /actuator/refresh 호출**
```bash
POST http://order-service/actuator/refresh
```

**방법 3: Spring Cloud Bus (자동 전파)**
```
설정 변경 → Config Server → Kafka/RabbitMQ → 모든 서비스 자동 갱신
````

---

## 주요 도구

| 도구                  | 특징                            |
| ------------------- | ----------------------------- |
| Spring Cloud Config | Spring 생태계, Git 연동            |
| Consul              | Service Discovery + Config 통합 |
| AWS Parameter Store | AWS 관리형                       |
| HashiCorp Vault     | 민감 정보 특화                      |

---

## 장단점

|장점|단점|
|---|---|
|설정 중앙 관리|Config Server 장애 시 문제|
|재배포 없이 변경|설정 복잡도 증가|
|환경별 관리 쉬움||

---

## 관련 개념

- [[01. Microservices Architecture (기본 개념)]]
- [[04. Service Discovery (서비스 디스커버리)]]

---

## Tags

#ConfigServer #MSA #설정관리 #SpringCloudConfig