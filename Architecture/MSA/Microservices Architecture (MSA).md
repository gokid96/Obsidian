
MSA는 **서비스를 작은 단위로 분리하는 아키텍처**

---

## 모놀리식 vs MSA

### 모놀리식

```
	┌─────────────────────────────────┐
	│           하나의 서비스           │
	│  ┌───────┬───────┬───────────┐ │
	│  │ 주문  │ 결제  │ 배송       │ │
	│  └───────┴───────┴───────────┘ │
	│            하나의 DB            │
	└─────────────────────────────────┘
```

### MSA

```
	┌─────────┐  ┌─────────┐  ┌─────────┐
	│ 주문     │  │ 결제    │  │ 배송     │
	│ 서비스   │  │ 서비스   │  │ 서비스   │
	│  (DB)   │  │  (DB)   │  │  (DB)   │
	└─────────┘  └─────────┘  └─────────┘
```

---

## 특징

- 서비스별로 독립적인 배포 가능
- 서비스별로 다른 기술 스택 사용 가능
- 서비스별로 DB 분리 (데이터 독립성)
- 장애 격리 (하나 죽어도 전체 안 죽음)

---

## 통신 방식

MSA에서 서비스 간 통신은 두 가지 방식이 있다.

### 동기 방식 (REST, gRPC)

```
order-service ──HTTP 호출──→ payment-service
                    │
              응답 기다림
```

### 비동기 방식 (Event-Driven)

```
order-service ──이벤트 발행──→ Kafka ──→ payment-service
                    │
              응답 안 기다림
```

---

## 장단점

| 장점       | 단점                    |
| -------- | --------------------- |
| 독립 배포    | 분산 시스템 복잡도 증가         |
| 기술 스택 자유 | 서비스 간 통신 오버헤드         |
| 확장 용이    | 트랜잭션 관리 어려움 (Saga 필요) |
| 장애 격리    | 모니터링, 디버깅 어려움         |

---

## 언제 MSA를 써야 하는가

|모놀리식|MSA|
|---|---|
|팀 규모 작음 (10명 이하)|팀 규모 큼 (여러 팀)|
|서비스 초기 단계|서비스가 충분히 성숙함|
|빠른 MVP 개발|독립적 배포/확장 필요|
|트래픽 예측 가능|특정 기능만 스케일 아웃 필요|

### 주의

- 처음부터 MSA로 시작하면 오버엔지니어링 될 수 있음
- 보통 모놀리식 → 서비스 커짐 → 점진적 MSA 전환
- "MSA가 좋다"가 아니라 "상황에 맞게 선택"

---

## MSA 구성 요소 동기 방식 (REST/gRPC)

```
┌─────────────────────────────────────────────────────────────────┐
│                         Client                                  │
└──────────────────────────┬──────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────────────┐
│                      API Gateway                                │
│              (인증, 라우팅, 로드밸런싱)                            │
└──────────────────────────────┬───────────────────────────────────┘
	                           │
	        ┌──────────────────┼──────────────────┐
	        ▼                  ▼                  ▼
	┌─────────────┐    ┌─────────────┐    ┌─────────────┐
	│ order       │    │ payment     │    │ delivery    │
	│ service     │    │ service     │    │ service     │
	└──────┬──────┘    └──────┬──────┘    └──────┬──────┘
	       │                  │                  │
	       ▼                  ▼                  ▼
	┌─────────────┐    ┌─────────────┐    ┌─────────────┐
	│   Order DB  │    │  Payment DB │    │ Delivery DB │
	└─────────────┘    └─────────────┘    └─────────────┘
```
## 비동기 방식 (Event-Driven)

```
┌─────────────────────────────────────────────────────────────────┐
│                         Client                                  │
└──────────────────────────┬──────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────────────┐
│                      API Gateway                                │
└──────────────────────────┬──────────────────────────────────────┘
                           │
                           ▼
                    ┌─────────────┐
                    │   order     │
                    │   service   │
                    └──────┬──────┘
                           │ 이벤트 발행
                           ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Kafka                                    │
└────────┬──────────────────────────────────────┬─────────────────┘
         │                                      │
         ▼                                      ▼
  ┌─────────────┐                        ┌─────────────┐
  │  payment    │                        │  delivery   │
  │  service    │                        │  service    │
  └─────────────┘                        └─────────────┘
```
### 핵심 구성 요소

|구성 요소|역할|예시|
|---|---|---|
|API Gateway|단일 진입점, 인증, 라우팅|Kong, Spring Cloud Gateway|
|Service Discovery|서비스 위치 찾기|Eureka, Consul|
|Config Server|설정 중앙 관리|Spring Cloud Config|
|Message Broker|서비스 간 비동기 통신|Kafka, RabbitMQ|
|Circuit Breaker|장애 전파 방지|Resilience4j, Hystrix|

### 부가 구성 요소

|구성 요소|역할|예시|
|---|---|---|
|분산 트레이싱|요청 흐름 추적|Jaeger, Zipkin|
|중앙 로깅|로그 수집/분석|ELK Stack|
|모니터링|메트릭 수집/시각화|Prometheus, Grafana|

---

## 관련 개념

- [[Event-Driven Architecture]]
- [[Saga Pattern]]
- [[Kafka]]
- [[서비스 디스커버리]]

---

## Tags

#MSA #Architecture #분산시스템