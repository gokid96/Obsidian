
```
┌─────────────────────────────────────────────────────────────────────┐
│                    VPC (vpc-0a4f1e6e1426a430a)                      │
│                        172.31.0.0/16                                │
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │              Internet Gateway (igw-0b425652173d12836)         │  │
│  │                        (현관문)                                │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                │                                    │
│         ┌──────────────────────┴──────────────────────┐             │
│         ▼                                              ▼            │
│  ┌─────────────────────────┐        ┌─────────────────────────┐     │
│  │  rtb-0e4a7b9eb7e24c7a6  │        │       RDS-Pvt-rt        │     │
│  │  (기본 라우팅 테이블)     │        │       (명시적 연결)       │     │
│  │                         │        │                         │     │
│  │  172.31.0.0/16 → local  │        │  172.31.0.0/16 → local  │     │
│  │  0.0.0.0/0 → IGW ✅     │        │  0.0.0.0/0 → IGW ✅    │     │
│  └─────────────────────────┘        └─────────────────────────┘     │
│              │                                   │                  │
│              ▼                                   ▼                  │
│  ┌─────────────────────────┐        ┌─────────────────────────┐     │
│  │        EC2- 서브넷       │        │   RDS-Pvt-subnet-1      │     │
│  │     172.31.48.0/20      │        │     172.31.64.0/25      │     │
│  │      (암시적 연결)        │        │      (명시적 연결)       │     │
│  │                         │        │                         │     │
│  │       🖥️ EC2           │◀──────▶│       🗄️ RDS            │      │
│  │      (웹서버)            │ 내부통신 │    (untitles-db)       │     │
│  └─────────────────────────┘        └─────────────────────────┘     │
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │                  Security Group (rds-ec2-2)                   │  │
│  │              Inbound: 3306 ← 203.242.143.3/32                 │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
                    ┌───────────────────┐
                    │      인터넷        │
                    │                   │
                    │   💻 로컬 PC      │
                    │  203.242.143.3    │
                    │  Spring Boot App  │
                    └───────────────────┘
```

---

## 핵심 개념 정리

|AWS 리소스|비유|역할|
|---|---|---|
|VPC|빌딩|나만의 격리된 네트워크|
|Internet Gateway|현관문|외부 인터넷과 연결|
|서브넷|층/구역|IP 범위를 나눈 구역|
|라우팅 테이블|이정표|트래픽을 어디로 보낼지 결정|
|Security Group|경비원|허용된 IP/포트만 통과|

---

## 라우팅 테이블 규칙

| 규칙                      | 의미                   |
| ----------------------- | -------------------- |
| `172.31.0.0/16 → local` | 목적지가 VPC 내부면 → 내부 전달 |
| `0.0.0.0/0 → IGW`       | 목적지가 외부면 → 인터넷으로 전달  |

---

## 로컬에서 RDS 접속하기

| 문제              | 원인                    | 해결                   |
| --------------- | --------------------- | -------------------- |
| 로컬에서 RDS 연결 안 됨 | RDS-Pvt-rt에 IGW 규칙 없음 | `0.0.0.0/0 → IGW` 추가 |

## 보편적인 운영 환경 (참고)

현재는 사이드 프로젝트용으로 RDS를 퍼블릭하게 열었지만, **실제 운영 환경**에서는 다르게 구성

```
┌─────────────────────────────────────────────────────────────────┐
│                           VPC                                   │
│                                                                 │
│   ┌─────────────────┐         ┌─────────────────┐               │
│   │  퍼블릭 서브넷    │         │  프라이빗 서브넷   │              │
│   │  (IGW 연결 ✅)   │         │  (IGW 없음 ❌)   │              │
│   │                 │         │                 │              │
│   │  🖥️ Bastion    │ ──SSH──▶│   🗄️ RDS       │              │
│   │  (점프 서버)     │   터널   │   (DB)          │              │
│   └─────────────────┘         └─────────────────┘              │
│           │                                                     │
└───────────│─────────────────────────────────────────────────────┘
            │
            ▼
       💻 개발자 PC
       (SSH 터널링으로 RDS 접속)
```

| 구분     | 현재 (사이드 프로젝트) | 보편적 운영 환경       |
| ------ | ------------- | --------------- |
| RDS 위치 | 퍼블릭 (IGW 연결)  | 프라이빗 (IGW 없음)   |
| RDS 접근 | 로컬에서 직접 접속    | Bastion 통해서만 접속 |
| 보안     | 보안 그룹 IP 제한   | 네트워크 자체 차단      |
| 장점     | 편리함           | 보안 강화           |
ddddd
dddddd
dddddd