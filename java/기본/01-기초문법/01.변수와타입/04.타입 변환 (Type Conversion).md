## 개요

- 변수의 타입을 다른 타입으로 변환하는 것
- **자동 형변환**과 **강제 형변환** 두 가지 방식

---

## 자동 형변환 (묵시적 형변환)

### 원리

- 작은 타입 → 큰 타입으로 자동 변환
- 데이터 손실 없음

### 변환 순서

```
byte → short → int → long → float → double
         ↑
        char
```

### 예시

```java
byte b = 10;
int i = b;       // byte → int (자동)
long l = i;      // int → long (자동)
float f = l;     // long → float (자동)
double d = f;    // float → double (자동)

System.out.println(d);  // 10.0
```

### char와 int

```java
char ch = 'A';
int code = ch;   // char → int (자동)
System.out.println(code);  // 65

// 주의: byte/short → char는 자동 변환 안됨
byte b = 65;
// char c = b;  // 컴파일 에러!
char c = (char) b;  // 강제 변환 필요
```

### 연산에서의 자동 변환

```java
int i = 10;
double d = 5.5;
double result = i + d;  // int가 double로 자동 변환
System.out.println(result);  // 15.5

// 정수 연산 주의
int a = 10;
int b = 4;
System.out.println(a / b);      // 2 (정수 / 정수 = 정수)
System.out.println(a / (double)b);  // 2.5
```

---

## 강제 형변환 (명시적 형변환)

### 원리

- 큰 타입 → 작은 타입으로 변환
- 데이터 손실 가능 → **(타입)** 명시 필요

### 문법

```java
(변환할타입) 값
```

### 예시

```java
double d = 3.14;
int i = (int) d;      // 3 (소수점 버림)

long l = 100L;
int i2 = (int) l;     // 100

int big = 300;
byte b = (byte) big;  // 44 (오버플로우!)
```

### 데이터 손실

```java
// 소수점 손실
double pi = 3.14159;
int n = (int) pi;
System.out.println(n);  // 3

// 오버플로우 (범위 초과)
int i = 128;
byte b = (byte) i;
System.out.println(b);  // -128 (오버플로우!)

// 계산 과정
// 128 = 0000 0000 0000 0000 0000 0000 1000 0000 (32bit)
// byte로 변환 시 하위 8bit만 → 1000 0000 → -128
```

---

## 정수 연산의 형변환

### int 미만 타입의 연산

```java
byte a = 10;
byte b = 20;
// byte c = a + b;  // 컴파일 에러! 결과가 int
int c = a + b;      // OK
byte d = (byte)(a + b);  // 강제 변환 필요
```

### 왜 int로 변환될까?

- JVM은 기본적으로 32bit(int) 단위로 연산
- byte, short, char 연산 결과는 항상 int

### 예시

```java
short s1 = 10;
short s2 = 20;
// short s3 = s1 + s2;  // 에러!
int s3 = s1 + s2;       // OK
short s4 = (short)(s1 + s2);  // OK

char c1 = 'A';
char c2 = 'B';
// char c3 = c1 + c2;  // 에러!
int c3 = c1 + c2;      // 131 (65 + 66)
```

---

## 실수 연산의 형변환

### float과 double

```java
float f1 = 1.5F;
float f2 = 2.5F;
float f3 = f1 + f2;  // OK (float + float = float)

double d1 = 1.5;
double d2 = 2.5;
double d3 = d1 + d2;  // OK

// float + double = double
float f = 1.5F;
double d = 2.5;
double result = f + d;  // f가 double로 자동 변환
```

### 정수와 실수 연산

```java
int i = 10;
double d = 3.0;
double result = i / d;  // int가 double로 변환
System.out.println(result);  // 3.333...

// 주의!
int a = 10;
int b = 3;
double r = a / b;  // 정수 나눗셈 먼저 수행!
System.out.println(r);  // 3.0 (3.333이 아님!)

// 해결
double r2 = (double) a / b;  // 3.333...
double r3 = a / (double) b;  // 3.333...
double r4 = (double) a / (double) b;  // 3.333...
```

---

## 문자열 변환

### 숫자 → 문자열

```java
// 방법 1: String.valueOf()
int num = 100;
String s1 = String.valueOf(num);  // "100"

// 방법 2: + 연산
String s2 = num + "";  // "100"

// 방법 3: Wrapper 클래스
String s3 = Integer.toString(num);  // "100"

// 실수
double d = 3.14;
String s4 = String.valueOf(d);  // "3.14"
```

### 문자열 → 숫자

```java
// Integer.parseInt()
String s1 = "100";
int n1 = Integer.parseInt(s1);  // 100

// Double.parseDouble()
String s2 = "3.14";
double n2 = Double.parseDouble(s2);  // 3.14

// Wrapper 클래스의 valueOf()
Integer n3 = Integer.valueOf("100");  // Integer 객체
int n4 = Integer.valueOf("100");      // 오토언박싱

// 진법 변환
int n5 = Integer.parseInt("1010", 2);   // 2진수 → 10 (10진수)
int n6 = Integer.parseInt("FF", 16);    // 16진수 → 255 (10진수)
```

### 변환 실패 시

```java
String invalid = "abc";
// int n = Integer.parseInt(invalid);  // NumberFormatException!

// 안전한 변환
try {
    int n = Integer.parseInt(invalid);
} catch (NumberFormatException e) {
    System.out.println("숫자 변환 실패");
}
```

---

## 형변환 정리표

### 자동 형변환 (묵시적)

|From|To|예시|
|---|---|---|
|byte|short, int, long, float, double|`int i = b;`|
|short|int, long, float, double|`int i = s;`|
|char|int, long, float, double|`int i = c;`|
|int|long, float, double|`long l = i;`|
|long|float, double|`float f = l;`|
|float|double|`double d = f;`|

### 강제 형변환 (명시적)

|From|To|예시|주의|
|---|---|---|---|
|double|float, long, int, short, byte|`int i = (int)d;`|소수점 손실|
|float|long, int, short, byte|`int i = (int)f;`|소수점 손실|
|long|int, short, byte|`int i = (int)l;`|오버플로우|
|int|short, byte, char|`byte b = (byte)i;`|오버플로우|

---

## 자주 하는 실수

### 1. 정수 나눗셈

```java
// 잘못된 예
double avg = 10 / 4;  // 2.0 (10/4=2 후 double로)

// 올바른 예
double avg = 10.0 / 4;    // 2.5
double avg = (double)10 / 4;  // 2.5
```

### 2. byte/short 연산

```java
byte a = 10, b = 20;
// byte c = a + b;  // 에러!
byte c = (byte)(a + b);  // OK
```

### 3. char 연산

```java
char c = 'A';
// char next = c + 1;  // 에러!
char next = (char)(c + 1);  // 'B'
```

### 4. 오버플로우 무시

```java
int big = 1000000;
// byte b = (byte)big;  // 예상치 못한 값!

// 범위 확인 필요
if (big >= Byte.MIN_VALUE && big <= Byte.MAX_VALUE) {
    byte b = (byte) big;
}
```

---

> [!tip] 핵심 정리
> 
> - 작은 → 큰 타입: **자동 변환**
> - 큰 → 작은 타입: **강제 변환** `(타입)`
> - byte, short, char 연산 결과는 항상 **int**
> - 정수/정수 = 정수 (소수점 없음!)
> - 문자열 ↔ 숫자: `parseInt()`, `valueOf()`, `toString()`

---

#Java #타입변환 #형변환 #기초문법