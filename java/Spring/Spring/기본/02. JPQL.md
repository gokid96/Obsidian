## JPQL이란?
JPQL은 JPA에서 제공하는 **객체 지향 쿼리 언어** SQL과 비슷하지만, 데이터베이스 테이블이 아닌 **엔티티 객체를 대상**으로 쿼리를 작성한다는 점이 핵심
## 주요 특징

**1. 데이터베이스 독립적**
- JPQL로 작성하면 JPA가 각 데이터베이스에 맞는 SQL로 변환
- MySQL, Oracle, PostgreSQL 등 DB를 바꿔도 쿼리 수정이 필요 없음

**2. 객체 지향적**
- 테이블명이 아닌 엔티티 클래스명을 사용
- 컬럼명이 아닌 필드명을 사용


```java
// PostRepository가 두 개를 동시에 다중 상속받음
public interface PostRepository extends JpaRepository<Post, Long>, PostRepositoryCustom {
    // 간단한 메서드명 쿼리
    List<Post> findByUserId(Long userId);
}
```


```java
// 커스텀 인터페이스 (복잡한 쿼리 메서드 정의)
public interface PostRepositoryCustom {
    List<Post> searchPosts(String keyword, LocalDateTime startDate, LocalDateTime endDate);
    Long countPostsByUserId(Long userId);
}
```

```java
// 구현체 (JPQL로 실제 구현)
@Repository
public class PostRepositoryCustomImpl implements PostRepositoryCustom {
    
    @PersistenceContext
    private EntityManager em;
    
    @Override
    public List<Post> searchPosts(String keyword, LocalDateTime startDate, LocalDateTime endDate) {
        String jpql = "SELECT p FROM Post p " +
                     "WHERE p.title LIKE :keyword " +
                     "AND p.createdAt BETWEEN :startDate AND :endDate";
        
        return em.createQuery(jpql, Post.class)
                .setParameter("keyword", "%" + keyword + "%")
                .setParameter("startDate", startDate)
                .setParameter("endDate", endDate)
                .getResultList();
    }
    
    @Override
    public Long countPostsByUserId(Long userId) {
        String jpql = "SELECT COUNT(p) FROM Post p WHERE p.user.id = :userId";
        return em.createQuery(jpql, Long.class)
                .setParameter("userId", userId)
                .getSingleResult();
    }
}
```

## 사용할 때

```java
@Service
@RequiredArgsConstructor
public class PostService {
    private final PostRepository postRepository; // 하나만 주입받으면 됨!
    
    public void example() {
        // JpaRepository 메서드
        Post post = postRepository.findById(1L).orElseThrow();
        postRepository.save(post);
        
        // 메서드명 쿼리
        List<Post> userPosts = postRepository.findByUserId(1L);
        
        // 커스텀 JPQL 메서드
        List<Post> searchResults = postRepository.searchPosts("제목", start, end);
        Long count = postRepository.countPostsByUserId(1L);
    }
}
// postRepository.searchPosts() 호출 시: 
// 1. PostRepository는 PostRepositoryCustom 인터페이스를 상속 
// 2. Spring이 PostRepositoryCustomImpl 구현체를 자동으로 찾음 
// 3. Impl의 실제 JPQL 코드가 실행됨 postRepository.searchPosts("키워드", start, end);
```

**핵심은 PostRepository 하나만 주입받으면 모든 메서드를 다 쓸 수 있다**는 거예요!

- 기본 CRUD: `JpaRepository`에서
- 간단한 쿼리: `PostRepository`에 메서드명으로
- 복잡한 쿼리: `PostRepositoryCustom`에 정의 → `Impl`에서 JPQL로 구현
