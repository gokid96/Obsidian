## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”](#%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B0%9C%EC%9A%94)
2. [ë„ë©”ì¸ ë¶„ì„ (DDD)](#%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%B6%84%EC%84%9D-ddd)
3. [ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¤ê³„ (MSA)](#%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%84%A4%EA%B3%84-msa)
4. [ê¸°ìˆ  ìŠ¤íƒ](#%EA%B8%B0%EC%88%A0-%EC%8A%A4%ED%83%9D)
5. [ì¸í”„ë¼ êµ¬ì¡°](#%EC%9D%B8%ED%94%84%EB%9D%BC-%EA%B5%AC%EC%A1%B0)
6. [ë³´ì•ˆ ì„¤ê³„](#%EB%B3%B4%EC%95%88-%EC%84%A4%EA%B3%84)
7. [ë°ì´í„° í”Œë¡œìš°](#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%EC%9A%B0)

---

## ğŸ¯ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”

### ì „ì²´ êµ¬ì¡°ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     API Gateway (Kong/AWS API Gateway)       â”‚
â”‚                  (ì¸ì¦, ë¼ìš°íŒ…, Rate Limiting)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìë…€ ì•± (React Native)  ë¶€ëª¨ ì•± (React Native)  ê´€ë¦¬ì ì›¹    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ ë„ë©”ì¸ ë¶„ì„ (DDD)

### 1. ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ ì‹ë³„

#### **Core Domain (í•µì‹¬ ë„ë©”ì¸)**

```
1ï¸âƒ£ íˆ¬ì ê²Œì„ ë„ë©”ì¸ (Investment Game Context)
   - ê²Œì„ë¨¸ë‹ˆ ê´€ë¦¬
   - í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±
   - ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜
   - ìˆ˜ìµë¥  ê³„ì‚°

2ï¸âƒ£ ìš©ëˆ ê´€ë¦¬ ë„ë©”ì¸ (Allowance Context)
   - ìš©ëˆ ìš”ì²­/ìŠ¹ì¸
   - í™˜ì‚° ë¡œì§ (ê²Œì„ë¨¸ë‹ˆ â†’ ì‹¤ì œ ìš©ëˆ)
   - ì§€ê¸‰ ë‚´ì—­ ê´€ë¦¬
```

#### **Supporting Domain (ì§€ì› ë„ë©”ì¸)**

```
3ï¸âƒ£ ì‚¬ìš©ì ê´€ë¦¬ ë„ë©”ì¸ (User Management Context)
   - íšŒì›ê°€ì…/ë¡œê·¸ì¸
   - ê°€ì¡± ê´€ê³„ ì„¤ì • (ë¶€ëª¨-ìë…€)
   - ê¶Œí•œ ê´€ë¦¬

4ï¸âƒ£ ì‹œì¥ ë°ì´í„° ë„ë©”ì¸ (Market Data Context)
   - ì‹¤ì‹œê°„ ì£¼ê°€ ì¡°íšŒ
   - ì¢…ëª© ì •ë³´ ê´€ë¦¬
   - ë‰´ìŠ¤/ê³µì‹œ ìˆ˜ì§‘
```

#### **Generic Domain (ì¼ë°˜ ë„ë©”ì¸)**

```
5ï¸âƒ£ ì•Œë¦¼ ë„ë©”ì¸ (Notification Context)
   - í‘¸ì‹œ ì•Œë¦¼
   - ì´ë©”ì¼/SMS ë°œì†¡

6ï¸âƒ£ ê²°ì œ ë„ë©”ì¸ (Payment Context)
   - í”„ë¦¬ë¯¸ì—„ êµ¬ë…
   - ì‹¤ì œ ìš©ëˆ ì§€ê¸‰ ì—°ë™
```

### 2. ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„

#### íˆ¬ì ê²Œì„ ë„ë©”ì¸

typescript

```typescript
// Aggregate Root
class GamePortfolio {
  portfolioId: PortfolioId
  userId: UserId
  gameBalance: Money
  holdings: Holding[]
  
  // Domain Logic
  buyStock(stock: Stock, quantity: number): void
  sellStock(stockId: StockId, quantity: number): void
  calculateReturns(): ReturnRate
  requestAllowance(): AllowanceRequest
}

// Value Object
class Money {
  amount: number
  currency: 'GAME' | 'KRW'
}

// Entity
class Holding {
  holdingId: HoldingId
  stock: Stock
  quantity: number
  avgPurchasePrice: Money
  currentValue: Money
}
```

#### ìš©ëˆ ê´€ë¦¬ ë„ë©”ì¸

typescript

```typescript
// Aggregate Root
class AllowanceRequest {
  requestId: RequestId
  childId: UserId
  parentId: UserId
  gameProfit: Money
  convertedAmount: Money  // ê²Œì„ë¨¸ë‹ˆ / 10
  status: 'PENDING' | 'APPROVED' | 'REJECTED'
  
  // Domain Logic
  approve(parentId: UserId): void
  reject(parentId: UserId, reason: string): void
  calculateConversion(rate: number): Money
}

// Domain Service
class AllowanceCalculationService {
  calculateAllowance(portfolio: GamePortfolio): Money {
    const profit = portfolio.calculateReturns()
    if (profit.amount <= 0) return Money.ZERO
    return new Money(profit.amount / 10, 'KRW')
  }
}
```

---

## ğŸ”§ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¤ê³„ (MSA)

### ì„œë¹„ìŠ¤ ëª©ë¡ ë° ì±…ì„

#### 1ï¸âƒ£ **User Service** (ì‚¬ìš©ì ê´€ë¦¬)

yaml

```yaml
í¬íŠ¸: 8001
ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL
ì±…ì„:
  - íšŒì›ê°€ì…/ë¡œê·¸ì¸ (JWT í† í° ë°œê¸‰)
  - ê°€ì¡± ê´€ê³„ ì„¤ì •
  - í”„ë¡œí•„ ê´€ë¦¬
API:
  POST /api/users/register
  POST /api/users/login
  POST /api/users/family/link
  GET  /api/users/{userId}/profile
```

#### 2ï¸âƒ£ **Investment Game Service** (íˆ¬ì ê²Œì„ í•µì‹¬)

yaml

```yaml
í¬íŠ¸: 8002
ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL + Redis (ìºì‹±)
ì±…ì„:
  - ê²Œì„ë¨¸ë‹ˆ ê´€ë¦¬
  - ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜
  - í¬íŠ¸í´ë¦¬ì˜¤ ê³„ì‚°
  - ìˆ˜ìµë¥  ë¶„ì„
API:
  GET  /api/game/portfolio/{userId}
  POST /api/game/trade/buy
  POST /api/game/trade/sell
  GET  /api/game/performance/{userId}
```

#### 3ï¸âƒ£ **Market Data Service** (ì‹œì¥ ë°ì´í„°)

yaml

```yaml
í¬íŠ¸: 8003
ë°ì´í„°ë² ì´ìŠ¤: TimescaleDB (ì‹œê³„ì—´ DB)
ì™¸ë¶€ ì—°ë™: Alpha Vantage, Yahoo Finance API
ì±…ì„:
  - ì‹¤ì‹œê°„ ì£¼ê°€ ì¡°íšŒ
  - ê³¼ê±° ë°ì´í„° ì œê³µ
  - ì¢…ëª© ê²€ìƒ‰
API:
  GET  /api/market/stocks/{symbol}/price
  GET  /api/market/stocks/{symbol}/history
  GET  /api/market/search?keyword=ì‚¼ì„±
```

#### 4ï¸âƒ£ **Allowance Service** (ìš©ëˆ ê´€ë¦¬)

yaml

```yaml
í¬íŠ¸: 8004
ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL
ì±…ì„:
  - ìš©ëˆ ìš”ì²­ ìƒì„±
  - ë¶€ëª¨ ìŠ¹ì¸/ê±°ì ˆ
  - ì§€ê¸‰ ë‚´ì—­ ê´€ë¦¬
  - í™˜ì‚° ë¡œì§
API:
  POST /api/allowance/request
  PUT  /api/allowance/{requestId}/approve
  GET  /api/allowance/history/{userId}
```

#### 5ï¸âƒ£ **Notification Service** (ì•Œë¦¼)

yaml

```yaml
í¬íŠ¸: 8005
ë©”ì‹œì§€ í: RabbitMQ / AWS SQS
ì±…ì„:
  - í‘¸ì‹œ ì•Œë¦¼ (FCM)
  - ì´ë©”ì¼ ë°œì†¡
  - ì´ë²¤íŠ¸ ê¸°ë°˜ ì•Œë¦¼
API:
  POST /api/notifications/push
  POST /api/notifications/email
```

#### 6ï¸âƒ£ **Payment Service** (ê²°ì œ)

yaml

```yaml
í¬íŠ¸: 8006
ì™¸ë¶€ ì—°ë™: í† ìŠ¤í˜ì´ë¨¼ì¸ , ì¹´ì¹´ì˜¤í˜ì´
ì±…ì„:
  - í”„ë¦¬ë¯¸ì—„ êµ¬ë… ê²°ì œ
  - ì‹¤ì œ ìš©ëˆ ì§€ê¸‰ (ê³„ì¢Œ ì´ì²´)
API:
  POST /api/payment/subscribe
  POST /api/payment/transfer
```

### ì„œë¹„ìŠ¤ ê°„ í†µì‹ 

#### ë™ê¸° í†µì‹  (REST/gRPC)

```
User Service â†’ Investment Game Service (ì‚¬ìš©ì ê²€ì¦)
Investment Game Service â†’ Market Data Service (ì£¼ê°€ ì¡°íšŒ)
Allowance Service â†’ Investment Game Service (ìˆ˜ìµë¥  í™•ì¸)
```

#### ë¹„ë™ê¸° í†µì‹  (Event-Driven)

```
Investment Game Service --[TradeExecutedEvent]--> Notification Service
Allowance Service --[AllowanceApprovedEvent]--> Payment Service
Allowance Service --[AllowanceRequestedEvent]--> Notification Service
```

---

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

### Backend

yaml

```yaml
ì–¸ì–´: 
  - Kotlin + Spring Boot (User, Allowance)
  - Node.js + NestJS (Investment Game, Market Data)
  
í”„ë ˆì„ì›Œí¬:
  - Spring Cloud (ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬)
  - Netflix Eureka (ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬)
  
í†µì‹ :
  - REST API (ê¸°ë³¸)
  - gRPC (ì„œë¹„ìŠ¤ ê°„ ê³ ì„±ëŠ¥ í†µì‹ )
  - GraphQL (í´ë¼ì´ì–¸íŠ¸ ìµœì í™”)
```

### Database

yaml

```yaml
ê´€ê³„í˜•: PostgreSQL (User, Allowance, Investment)
ì‹œê³„ì—´: TimescaleDB (Market Data ê³¼ê±° ë°ì´í„°)
ìºì‹œ: Redis (ì‹¤ì‹œê°„ ì£¼ê°€, ì„¸ì…˜)
ê²€ìƒ‰: Elasticsearch (ì¢…ëª© ê²€ìƒ‰)
```

### ë©”ì‹œì§€ í

yaml

```yaml
RabbitMQ / AWS SQS (ì´ë²¤íŠ¸ ë²„ìŠ¤)
Kafka (ëŒ€ìš©ëŸ‰ ë¡œê·¸, ë¶„ì„)
```

### Frontend

yaml

```yaml
ëª¨ë°”ì¼: React Native (iOS/Android)
ì›¹: Next.js + TypeScript
ìƒíƒœê´€ë¦¬: Zustand / Redux Toolkit
```

### ì¸í”„ë¼

yaml

```yaml
ì»¨í…Œì´ë„ˆ: Docker + Kubernetes (EKS)
CI/CD: GitHub Actions + ArgoCD
ëª¨ë‹ˆí„°ë§: Prometheus + Grafana
ë¡œê¹…: ELK Stack (Elasticsearch, Logstash, Kibana)
APM: Datadog / New Relic
```

---

## â˜ï¸ ì¸í”„ë¼ êµ¬ì¡°

### AWS ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Route 53 (DNS)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CloudFront (CDN) + WAF                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Application Load Balancer (ALB)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   EKS Cluster   â”‚                  â”‚   API Gateway   â”‚
â”‚   (Kubernetes)  â”‚                  â”‚   (REST/GraphQL)â”‚
â”‚                 â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ User Svc    â”‚ â”‚
â”‚ â”‚ Game Svc    â”‚ â”‚
â”‚ â”‚ Market Svc  â”‚ â”‚
â”‚ â”‚ ...         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RDS (PostgreSQL Multi-AZ)                 â”‚
â”‚  ElastiCache (Redis)                       â”‚
â”‚  S3 (ì •ì  íŒŒì¼, ë¡œê·¸)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê°œë°œ/ìš´ì˜ í™˜ê²½ ë¶„ë¦¬

yaml

```yaml
í™˜ê²½:
  - dev: ê°œë°œ í™˜ê²½ (ë‹¨ì¼ í´ëŸ¬ìŠ¤í„°)
  - staging: ìŠ¤í…Œì´ì§• (í”„ë¡œë•ì…˜ ë¯¸ëŸ¬ë§)
  - prod: ìš´ì˜ í™˜ê²½ (HA êµ¬ì„±)

ë¸Œëœì¹˜ ì „ëµ:
  - feature/* â†’ dev
  - develop â†’ staging
  - main â†’ prod
```

---

## ğŸ”’ ë³´ì•ˆ ì„¤ê³„

### ì¸ì¦/ì¸ê°€

yaml

```yaml
ì¸ì¦:
  - JWT í† í° (Access Token: 15ë¶„, Refresh Token: 7ì¼)
  - OAuth 2.0 (ì†Œì…œ ë¡œê·¸ì¸)
  
ì¸ê°€:
  - RBAC (Role-Based Access Control)
    - CHILD: ìë…€ ê¶Œí•œ
    - PARENT: ë¶€ëª¨ ê¶Œí•œ
    - ADMIN: ê´€ë¦¬ì ê¶Œí•œ
```

### ë°ì´í„° ë³´í˜¸

yaml

```yaml
ì „ì†¡ ì¤‘: TLS 1.3 (HTTPS)
ì €ì¥ ì‹œ: AES-256 ì•”í˜¸í™” (ë¯¼ê° ì •ë³´)
ê°œì¸ì •ë³´: 
  - ë§ˆìŠ¤í‚¹ ì²˜ë¦¬ (ë¡œê·¸)
  - ìµœì†Œ ìˆ˜ì§‘ ì›ì¹™
  - ì •ê¸° ì‚­ì œ (3ë…„)
```

### API ë³´ì•ˆ

yaml

```yaml
Rate Limiting: 
  - ì¼ë°˜: 100 req/min
  - ê±°ë˜: 10 req/min
  
CORS: í—ˆìš© ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸
CSRF: Token ê¸°ë°˜ ë°©ì–´
Input Validation: ëª¨ë“  ì…ë ¥ ê²€ì¦
```

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1. íˆ¬ì ê²Œì„ í”Œë¡œìš°

mermaid

```mermaid
sequenceDiagram
    participant Child as ìë…€ ì•±
    participant API as API Gateway
    participant Game as Game Service
    participant Market as Market Service
    participant Notif as Notification Service
    
    Child->>API: ì‚¼ì„±ì „ì ë§¤ìˆ˜ ìš”ì²­
    API->>Game: ë§¤ìˆ˜ ì²˜ë¦¬
    Game->>Market: í˜„ì¬ê°€ ì¡°íšŒ
    Market-->>Game: 70,000ì›
    Game->>Game: í¬íŠ¸í´ë¦¬ì˜¤ ì—…ë°ì´íŠ¸
    Game-->>API: ë§¤ìˆ˜ ì™„ë£Œ
    API-->>Child: ì„±ê³µ ì‘ë‹µ
    Game->>Notif: TradeExecutedEvent
    Notif->>Child: í‘¸ì‹œ ì•Œë¦¼
```

### 2. ìš©ëˆ ìš”ì²­ í”Œë¡œìš°

mermaid

```mermaid
sequenceDiagram
    participant Child as ìë…€ ì•±
    participant Parent as ë¶€ëª¨ ì•±
    participant API as API Gateway
    participant Game as Game Service
    participant Allow as Allowance Service
    participant Payment as Payment Service
    
    Child->>API: ìš©ëˆ ìš”ì²­
    API->>Game: ìˆ˜ìµë¥  í™•ì¸
    Game-->>API: +15% (15,000ì› ìˆ˜ìµ)
    API->>Allow: ìš©ëˆ ìš”ì²­ ìƒì„± (1,500ì›)
    Allow->>Parent: AllowanceRequestedEvent
    Parent->>API: ìŠ¹ì¸
    API->>Allow: ìƒíƒœ ì—…ë°ì´íŠ¸
    Allow->>Payment: ì§€ê¸‰ ìš”ì²­
    Payment->>Child: ì‹¤ì œ ì†¡ê¸ˆ (1,500ì›)
```

### 3. ì‹¤ì‹œê°„ ì£¼ê°€ ì—…ë°ì´íŠ¸

mermaid

```mermaid
sequenceDiagram
    participant Market as Market Service
    participant Redis as Redis Cache
    participant External as ì™¸ë¶€ API
    participant WS as WebSocket
    participant Child as ìë…€ ì•±
    
    loop 5ì´ˆë§ˆë‹¤
        Market->>External: ì£¼ê°€ ì¡°íšŒ
        External-->>Market: ìµœì‹  ì£¼ê°€
        Market->>Redis: ìºì‹œ ì—…ë°ì´íŠ¸
        Market->>WS: ë¸Œë¡œë“œìºìŠ¤íŠ¸
        WS->>Child: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
    end
```

---

## ğŸ“Š ì„±ëŠ¥ ìµœì í™”

### ìºì‹± ì „ëµ

yaml

```yaml
ë ˆë²¨ 1 (CDN):
  - ì •ì  íŒŒì¼ (ì´ë¯¸ì§€, JS, CSS)
  - TTL: 1ì¼
  
ë ˆë²¨ 2 (Redis):
  - ì‹¤ì‹œê°„ ì£¼ê°€: 5ì´ˆ
  - í¬íŠ¸í´ë¦¬ì˜¤: 30ì´ˆ
  - ì‚¬ìš©ì ì„¸ì…˜: 15ë¶„
  
ë ˆë²¨ 3 (Application):
  - ì¢…ëª© ì •ë³´: 1ì‹œê°„
  - ë‰´ìŠ¤: 10ë¶„
```

### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

sql

```sql
-- ì¸ë±ìŠ¤ ì„¤ê³„
CREATE INDEX idx_portfolio_user ON portfolios(user_id);
CREATE INDEX idx_holdings_stock ON holdings(stock_id, user_id);
CREATE INDEX idx_trades_timestamp ON trades(created_at) WHERE status = 'COMPLETED';

-- íŒŒí‹°ì…”ë‹ (ì‹œê³„ì—´ ë°ì´í„°)
CREATE TABLE stock_prices (
    symbol VARCHAR(10),
    price DECIMAL(10,2),
    timestamp TIMESTAMPTZ
) PARTITION BY RANGE (timestamp);
```

---

## ğŸš€ ë°°í¬ ì „ëµ

### ë¬´ì¤‘ë‹¨ ë°°í¬ (Blue-Green)

yaml

```yaml
1. Blue í™˜ê²½ (í˜„ì¬ ìš´ì˜)
2. Green í™˜ê²½ì— ì‹ ê·œ ë²„ì „ ë°°í¬
3. Health Check í†µê³¼ í™•ì¸
4. íŠ¸ë˜í”½ì„ Greenìœ¼ë¡œ ì „í™˜
5. Blue í™˜ê²½ ëŒ€ê¸° (ë¡¤ë°±ìš©)
```

### ì¹´ë‚˜ë¦¬ ë°°í¬

yaml

```yaml
1. ì‹ ê·œ ë²„ì „ 5% íŠ¸ë˜í”½ìœ¼ë¡œ ë°°í¬
2. ì—ëŸ¬ìœ¨ ëª¨ë‹ˆí„°ë§ (1ì‹œê°„)
3. ì •ìƒ ì‹œ 50% â†’ 100% ì ì§„ í™•ëŒ€
4. ì´ìƒ ì‹œ ì¦‰ì‹œ ë¡¤ë°±
```

---

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

### í•µì‹¬ ì§€í‘œ

yaml

```yaml
Golden Signals:
  - Latency: P50, P95, P99 (< 500ms)
  - Traffic: RPS (ì´ˆë‹¹ ìš”ì²­)
  - Errors: 5xx ë¹„ìœ¨ (< 0.1%)
  - Saturation: CPU/ë©”ëª¨ë¦¬ (< 70%)

ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ:
  - DAU/MAU
  - í‰ê·  ê²Œì„ ë¨¸ë‹ˆ ìˆ˜ìµë¥ 
  - ìš©ëˆ ìš”ì²­ ìŠ¹ì¸ìœ¨
  - í”„ë¦¬ë¯¸ì—„ ì „í™˜ìœ¨
```

### ì•Œë¦¼ ì„¤ì •

yaml

```yaml
Critical (ì¦‰ì‹œ ëŒ€ì‘):
  - ì„œë¹„ìŠ¤ ë‹¤ìš´
  - DB ì¥ì• 
  - ê²°ì œ ì‹¤íŒ¨ìœ¨ > 5%
  
Warning (30ë¶„ ë‚´ í™•ì¸):
  - ì‘ë‹µ ì‹œê°„ > 2ì´ˆ
  - ì—ëŸ¬ìœ¨ > 1%
  - ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ > 80%
```